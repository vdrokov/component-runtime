
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Talend Component Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="css/bootstrap.css" media="screen">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.0/css/font-awesome.min.css" integrity="sha256-MUe1D3T3ocGLZQ2h8wgpcIz5BoTu1OZo8q0BjK5u/o0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css" />
    <!--[if lt IE 9]>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.ie.min.css" />
    <![endif]-->
    <link rel="stylesheet" href="css/documentation.css">
    <link rel="shortcut icon" href="images/favicon_0.ico" />
    <style>
    body{padding-top:50px}body>.navbar{-webkit-transition:background-color .3s ease-in;transition:background-color .3s ease-in}@media (min-width:768px){body>.navbar-transparent{background-color:transparent}body>.navbar-transparent .navbar-nav>.open>a{background-color:transparent!important}}#home{padding-top:0}#home .navbar-brand{padding:13.5px 15px 12.5px}#home .navbar-brand>img{display:inline;margin:0 10px;height:100%}#banner{min-height:300px;border-bottom:none}.table-of-contents{margin-top:1em}.page-header h1{font-size:4em}.bs-docs-section{margin-top:6em}.bs-docs-section h1{padding-top:100px}.bs-component{position:relative}.bs-component .modal{position:relative;top:auto;right:auto;left:auto;bottom:auto;z-index:1;display:block}.bs-component .modal-dialog{width:90%}.bs-component .popover{position:relative;display:inline-block;width:220px;margin:20px}#source-button{position:absolute;top:0;right:0;z-index:100;font-weight:700}.progress{margin-bottom:10px}footer{margin:5em 0}footer li{float:left;margin-right:1.5em;margin-bottom:1.5em}footer p{clear:left;margin-bottom:0}.splash{padding:9em 0 2em;background-color:#141d27;background-image:url(../img/bg.jpg);background-size:cover;background-attachment:fixed;color:#fff;text-align:center}.splash .logo{width:160px}.splash h1{font-size:3em}.splash #social{margin:2em 0}.splash .alert{margin:2em 0}.section-tout{padding:4em 0 3em;border-bottom:1px solid rgba(0,0,0,.05);background-color:#eaf1f1}.section-tout .fa{margin-right:.5em}.section-tout p{margin-bottom:3em}.section-preview{padding:4em 0 4em}.section-preview .preview{margin-bottom:4em;background-color:#eaf1f1}.section-preview .preview .image{position:relative}.section-preview .preview .image:before{box-shadow:inset 0 0 0 1px rgba(0,0,0,.1);position:absolute;top:0;left:0;width:100%;height:100%;content:"";pointer-events:none}.section-preview .preview .options{padding:1em 2em 2em;border:1px solid rgba(0,0,0,.05);border-top:none;text-align:center}.section-preview .preview .options p{margin-bottom:2em}.section-preview .dropdown-menu{text-align:left}.section-preview .lead{margin-bottom:2em}@media (max-width:767px){.section-preview .image img{width:100%}}.sponsor #carbonads{max-width:240px;margin:0 auto}.sponsor .carbon-text{display:block;margin-top:1em;font-size:12px}.sponsor .carbon-poweredby{float:right;margin-top:1em;font-size:10px}@media (max-width:767px){.splash{padding-top:4em}.splash .logo{width:100px}.splash h1{font-size:2em}#banner{margin-bottom:2em;text-align:center}}
    </style>
  </head>
  <body>
    <a class="github-fork-ribbon" target="_blank"
        href="https://github.com/talend/component-runtime" data-ribbon="Fork me on GitHub"
        title="Fork me on GitHub">Fork me on GitHub</a>
    <div class="col-sm-offset-1 col-sm-10">

	
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <a href="/component-runtime/index.html" class="navbar-brand">Component Kit</a>
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar-main">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="entries">Documentation <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="entries">
            <li><a href="/component-runtime/index.html">Home</a></li>
            <li><a href="documentation-overview.html">Overview</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="documentation.html">Reference</a></li>
            <li><a href="best-practices.html">Best Practices</a></li>
            <li><a href="documentation-testing.html">Testing</a></li>
            <li><a href="documentation-rest.html">REST API</a></li>
            <li><a href="wrapping-a-beam-io.html">How to wrap a Beam I/O</a></li>
            <li><a href="studio.html">Studio Integration</a></li>
            <li><a href="appendix.html">Appendix</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="versions">Versions <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="versions">
            <li><a href="/component-runtime/index.html">Current</a></li>
            <li><a href="/component-runtime/latest/index.html">Latest</a></li>
            
          </ul>
        </li>
      </ul>
    </div>
  </div>
</div>


    <div class="container section-padded">
        <div class="row title">
            <div class='page-header'>
              <h2>Talend Component Reference Guide</h2>
            </div>
        </div>
        <div class="row">
            
            <div class="col-md-12">
                <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_talend_component_design_choices">Talend Component Design Choices</a>
<ul class="sectlevel1">
<li><a href="#_component_api">1. Component API</a>
<ul class="sectlevel2">
<li><a href="#_evolution">1.1. Evolution</a></li>
<li><a href="#_static">1.2. Static</a>
<ul class="sectlevel3">
<li><a href="#_ui_friendly">1.2.1. UI friendly</a></li>
<li><a href="#_auditable_and_with_clear_expectations">1.2.2. Auditable and with clear expectations</a></li>
<li><a href="#_dev_friendly">1.2.3. Dev friendly</a></li>
</ul>
</li>
<li><a href="#_flexible_data_modeling">1.3. Flexible data modeling</a></li>
<li><a href="#_generic_and_specific">1.4. Generic and specific</a>
<ul class="sectlevel3">
<li><a href="#_no_runtime_assumption">1.4.1. No runtime assumption</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_isolated">2. Isolated</a></li>
<li><a href="#_rest">3. REST</a>
<ul class="sectlevel2">
<li><a href="#_consumable_model">3.1. Consumable model</a></li>
<li><a href="#_execution_with_streaming">3.2. Execution with streaming</a></li>
</ul>
</li>
<li><a href="#_fixed_set_of_icons">4. Fixed set of icons</a></li>
</ul>
</li>
<li><a href="#_talend_component_documentation_overview">Talend Component Documentation Overview</a>
<ul class="sectlevel1">
<li><a href="#_getting_help">1. Getting help</a></li>
<li><a href="#_first_steps">2. First steps</a></li>
<li><a href="#_learning_about_talend_component_features">3. Learning about Talend Component features</a></li>
</ul>
</li>
<li><a href="#_talend_component_getting_started">Talend Component Getting Started</a>
<ul class="sectlevel1">
<li><a href="#getting-started-introducing-talend-component">1. Introducing Talend Component</a></li>
<li><a href="#getting-started-system-requirements">2. Talend Component System Requirement</a></li>
<li><a href="#getting-started-first-quick-start">3. Quick Start</a>
<ul class="sectlevel2">
<li><a href="#_dependencies">3.1. Dependencies</a></li>
<li><a href="#_inputs">3.2. Inputs</a></li>
<li><a href="#_a_processor">3.3. A Processor</a></li>
<li><a href="#_an_output">3.4. An output</a></li>
<li><a href="#getting-started-components">3.5. Registering our components</a></li>
<li><a href="#getting-started-first-quick-start-run">3.6. Run the quick start example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_talend_component_documentation">Talend Component Documentation</a>
<ul class="sectlevel1">
<li><a href="#_components_definitions">1. Components Definitions</a>
<ul class="sectlevel2">
<li><a href="#_partitionmapper">1.1. PartitionMapper</a>
<ul class="sectlevel3">
<li><a href="#_definition">1.1.1. Definition</a>
<ul class="sectlevel4">
<li><a href="#_assessor">@Assessor</a></li>
<li><a href="#_split">@Split</a></li>
<li><a href="#_emitter">@Emitter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_producer">1.2. Producer</a></li>
<li><a href="#_processor">1.3. Processor</a>
<ul class="sectlevel3">
<li><a href="#_objectmap_and_dynamic_schemas">1.3.1. ObjectMap and dynamic schemas</a></li>
</ul>
</li>
<li><a href="#_multiple_outputs">1.4. Multiple outputs</a></li>
<li><a href="#_multiple_inputs">1.5. Multiple inputs</a>
<ul class="sectlevel3">
<li><a href="#_output">1.5.1. Output</a></li>
</ul>
</li>
<li><a href="#_combiners">1.6. Combiners?</a></li>
</ul>
</li>
<li><a href="#_registering_components">2. Registering components</a>
<ul class="sectlevel2">
<li><a href="#_components_metadata">2.1. Components metadata</a>
<ul class="sectlevel3">
<li><a href="#_management_of_configuration_versions">2.1.1. Management of configuration versions</a></li>
<li><a href="#_partitionmapper_2">2.1.2. @PartitionMapper</a>
<ul class="sectlevel4">
<li><a href="#_emitter_2">@Emitter</a></li>
</ul>
</li>
<li><a href="#_processor_2">2.1.3. @Processor</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_internationalization">3. Internationalization</a>
<ul class="sectlevel2">
<li><a href="#_internationalization_api">3.1. Internationalization API</a></li>
<li><a href="#_default_components_keys">3.2. Default components keys</a></li>
</ul>
</li>
<li><a href="#_component_loading">4. Component loading</a>
<ul class="sectlevel2">
<li><a href="#_packaging_a_plugin">4.1. Packaging a plugin</a></li>
<li><a href="#_packaging_an_application">4.2. Packaging an application</a>
<ul class="sectlevel3">
<li><a href="#_dependencies_2">4.2.1. Dependencies</a>
<ul class="sectlevel4">
<li><a href="#_create_a_nested_maven_repository_with_maven_shade_plugin">Create a nested maven repository with maven-shade-plugin</a></li>
</ul>
</li>
<li><a href="#_listing_needed_plugins">4.2.2. Listing needed plugins</a></li>
<li><a href="#_code_maven_shade_plugin_code_extensions">4.2.3. <code>maven-shade-plugin</code> extensions</a>
<ul class="sectlevel4">
<li><a href="#_containerdependenciestransformer">ContainerDependenciesTransformer</a></li>
<li><a href="#_plugintransformer">PluginTransformer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_configuring_component">5. Configuring component</a>
<ul class="sectlevel2">
<li><a href="#_primitives">5.1. Primitives</a></li>
<li><a href="#_complex_object_mapping">5.2. Complex object mapping</a>
<ul class="sectlevel3">
<li><a href="#_list_case">5.2.1. List case</a></li>
<li><a href="#_map_case">5.2.2. Map case</a></li>
</ul>
</li>
<li><a href="#_constraints_and_validation_on_the_configuration_input">5.3. Constraints and validation on the configuration/input</a></li>
<li><a href="#_marking_a_configuration_as_a_particular_type_of_data">5.4. Marking a configuration as a particular type of data</a></li>
<li><a href="#_define_links_between_properties">5.5. Define links between properties</a></li>
<li><a href="#documentation-ui-hints">5.6. Add hints about the rendering based on configuration/component knowledge</a></li>
</ul>
</li>
<li><a href="#_providing_some_actions_for_consumers_clients">6. Providing some actions for consumers/clients</a>
<ul class="sectlevel2">
<li><a href="#_particular_action_types">6.1. Particular action types</a></li>
</ul>
</li>
<li><a href="#_creating_an_execution_chain_or_pipeline">7. Creating an execution chain or pipeline</a>
<ul class="sectlevel2">
<li><a href="#_standalone_chains">7.1. Standalone chains</a></li>
<li><a href="#_beam_case">7.2. Beam case</a>
<ul class="sectlevel3">
<li><a href="#_i_o">7.2.1. I/O</a></li>
<li><a href="#_processors">7.2.2. Processors</a></li>
<li><a href="#_deployment">7.2.3. Deployment</a></li>
<li><a href="#_convert_a_beam_io_in_a_component_i_o">7.2.4. Convert a Beam.io in a component I/O</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_maven_plugin">8. Maven Plugin</a>
<ul class="sectlevel2">
<li><a href="#_validate">8.1. Validate</a></li>
<li><a href="#_prepare">8.2. Prepare</a></li>
<li><a href="#_generate_inputs_or_outputs">8.3. Generate inputs or outputs</a></li>
</ul>
</li>
<li><a href="#_advanced_define_a_custom_api">9. Advanced: define a custom API</a>
<ul class="sectlevel2">
<li><a href="#_extending_the_ui">9.1. Extending the UI</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_talend_component_documentation_testing">Talend Component Documentation Testing</a>
<ul class="sectlevel1">
<li><a href="#documentation-testing-start">1. Best practises</a>
<ul class="sectlevel2">
<li><a href="#_parameterized_tests">1.1. Parameterized tests</a></li>
</ul>
</li>
<li><a href="#_component_runtime_testing">2. component-runtime-testing</a>
<ul class="sectlevel2">
<li><a href="#_component_runtime_junit">2.1. component-runtime-junit</a>
<ul class="sectlevel3">
<li><a href="#_mocking_the_output">2.1.1. Mocking the output</a></li>
<li><a href="#_mocking_the_input">2.1.2. Mocking the input</a></li>
<li><a href="#_creating_runtime_configuration_from_component_configuration">2.1.3. Creating runtime configuration from component configuration</a></li>
<li><a href="#_testing_a_mapper">2.1.4. Testing a Mapper</a></li>
<li><a href="#_testing_a_processor">2.1.5. Testing a Processor</a></li>
</ul>
</li>
<li><a href="#_component_runtime_testing_spark">2.2. component-runtime-testing-spark</a>
<ul class="sectlevel3">
<li><a href="#_how_to_know_the_job_is_done">2.2.1. How to know the job is done</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_beam_testing">3. Beam testing</a></li>
<li><a href="#_generating_data">4. Generating data?</a></li>
</ul>
</li>
<li><a href="#_talend_component_best_practices">Talend Component Best Practices</a>
<ul class="sectlevel1">
<li><a href="#_organize_your_code">1. Organize your code</a></li>
<li><a href="#_modelize_your_configuration">2. Modelize your configuration</a></li>
<li><a href="#_i_o_configuration">3. I/O configuration</a></li>
<li><a href="#_processor_configuration">4. Processor configuration</a></li>
<li><a href="#_i_o_recommandations">5. I/O recommandations</a></li>
<li><a href="#_i_o_limitations">6. I/O limitations</a></li>
<li><a href="#_handle_ui_interactions">7. Handle UI interactions</a>
<ul class="sectlevel2">
<li><a href="#_validations">7.1. Validations</a>
<ul class="sectlevel3">
<li><a href="#_light_validations">7.1.1. Light validations</a></li>
<li><a href="#_custom_validations">7.1.2. Custom validations</a></li>
</ul>
</li>
<li><a href="#_completion">7.2. Completion</a></li>
<li><a href="#_don_t_forget_the_component_representation">7.3. Don&#8217;t forget the component representation</a></li>
</ul>
</li>
<li><a href="#_version_and_component">8. Version and component</a></li>
<li><a href="#_don_t_forget_to_test">9. Don&#8217;t forget to test</a></li>
<li><a href="#_contribute_to_this_guide">10. Contribute to this guide</a></li>
</ul>
</li>
<li><a href="#_talend_component_rest_api_documentation">Talend Component REST API Documentation</a>
<ul class="sectlevel1">
<li><a href="#_rest_api">1. REST API</a>
<ul class="sectlevel2">
<li><a href="#_rest_resources_of_component_runtime_server">1.1. REST resources of Component Runtime :: Server</a>
<ul class="sectlevel3">
<li><a href="#_code_post_api_v1_action_execute_code">1.1.1. <code>POST api/v1/action/execute</code></a>
<ul class="sectlevel4">
<li><a href="#_request">Request</a></li>
<li><a href="#_response">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_action_index_code">1.1.2. <code>GET api/v1/action/index</code></a>
<ul class="sectlevel4">
<li><a href="#_request_2">Request</a></li>
<li><a href="#_response_2">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_component_details_code">1.1.3. <code>GET api/v1/component/details</code></a>
<ul class="sectlevel4">
<li><a href="#_request_3">Request</a></li>
<li><a href="#_response_3">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_component_icon_family_id_code">1.1.4. <code>GET api/v1/component/icon/family/{id}</code></a>
<ul class="sectlevel4">
<li><a href="#_request_4">Request</a></li>
<li><a href="#_response_4">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_component_icon_id_code">1.1.5. <code>GET api/v1/component/icon/{id}</code></a>
<ul class="sectlevel4">
<li><a href="#_request_5">Request</a></li>
<li><a href="#_response_5">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_component_index_code">1.1.6. <code>GET api/v1/component/index</code></a>
<ul class="sectlevel4">
<li><a href="#_request_6">Request</a></li>
<li><a href="#_response_6">Response</a></li>
</ul>
</li>
<li><a href="#_code_post_api_v1_component_migrate_id_configurationversion_code">1.1.7. <code>POST api/v1/component/migrate/{id}/{configurationVersion}</code></a>
<ul class="sectlevel4">
<li><a href="#_request_7">Request</a></li>
<li><a href="#_response_7">Response</a></li>
</ul>
</li>
<li><a href="#_code_get_api_v1_configurationtype_index_code">1.1.8. <code>GET api/v1/configurationtype/index</code></a>
<ul class="sectlevel4">
<li><a href="#_request_8">Request</a></li>
<li><a href="#_response_8">Response</a></li>
</ul>
</li>
<li><a href="#_code_post_api_v1_execution_read_family_component_code">1.1.9. <code>POST api/v1/execution/read/{family}/{component}</code></a>
<ul class="sectlevel4">
<li><a href="#_request_9">Request</a></li>
<li><a href="#_response_9">Response</a></li>
</ul>
</li>
<li><a href="#_code_post_api_v1_execution_write_family_component_code">1.1.10. <code>POST api/v1/execution/write/{family}/{component}</code></a>
<ul class="sectlevel4">
<li><a href="#_request_10">Request</a></li>
<li><a href="#_response_10">Response</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_websocket_transport">1.2. WebSocket transport</a></li>
</ul>
</li>
<li><a href="#_web_forms_and_rest_api">2. Web forms and REST API</a></li>
<li><a href="#_logging">3. Logging</a></li>
</ul>
</li>
<li><a href="#_wrapping_a_beam_i_o">Wrapping a Beam I/O</a>
<ul class="sectlevel1">
<li><a href="#wrapping-a-beam-io__start">1. Limitations</a></li>
<li><a href="#_wrap_an_input">2. Wrap an input</a></li>
<li><a href="#_wrap_an_output">3. Wrap an output</a></li>
<li><a href="#_tip">4. Tip</a></li>
</ul>
</li>
<li><a href="#_talend_component_appendix">Talend Component Appendix</a>
<ul class="sectlevel1">
<li><a href="#_containermanager_or_the_classloader_manager">1. ContainerManager or the classloader manager</a>
<ul class="sectlevel2">
<li><a href="#_listener_for_plugin_registration">1.1. Listener for plugin registration</a></li>
</ul>
</li>
<li><a href="#_presentations">2. Presentations</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Version: 1.0.0-SNAPSHOT</p>
</div>
</div>
</div>
<h1 id="_talend_component_design_choices" class="sect0">Talend Component Design Choices</h1>
<div class="sect1">
<h2 id="_component_api">1. Component API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The component API has multiple strong choices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>it is declarative (through annotations) to ensure it is</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>evolutive (it can get new fancy featrues without breaking old code)</p>
</li>
<li>
<p>static as much as possible</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_evolution">1.1. Evolution</h3>
<div class="paragraph">
<p>Being fully declarative, any new API can be added iteratively without requiring
any changes to existing components.</p>
</div>
<div class="paragraph">
<p>Example (projection on beam potential evolution):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyOutput onElement(MyInput data) {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>wouldn&#8217;t be affected by the addition of the new Timer API
which can be used like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyOutput onElement(MyInput data,
                          <span style="color:#007">@Timer</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my-timer</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">Timer</span> timer) {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_static">1.2. Static</h3>
<div class="sect3">
<h4 id="_ui_friendly">1.2.1. UI friendly</h4>
<div class="paragraph">
<p>Intent of the framework is to be able to fit java UI as well as web UI.
It must be understood as colocalized and remote UI. The direct impact
of that choice is to try to move as much as possible the logic to the
UI side for UI related actions. Typically we want to validate a pattern,
a size, &#8230;&#8203; on the client side and not on the server side. Being static encourages this practise.</p>
</div>
</div>
<div class="sect3">
<h4 id="_auditable_and_with_clear_expectations">1.2.2. Auditable and with clear expectations</h4>
<div class="paragraph">
<p>The other goal to be really static in its definition is to ensure the model will not be mutated at runtime
and all the auditing and modelling can be done before, in the design phase.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dev_friendly">1.2.3. Dev friendly</h4>
<div class="paragraph">
<p>Being static also ensures the development can be validated as much as possible through build tools.
This doesn&#8217;t replace the requirement to test the components but helps the developer to maintain its components
with automated tools.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_flexible_data_modeling">1.3. Flexible data modeling</h3>

</div>
<div class="sect2">
<h3 id="_generic_and_specific">1.4. Generic and specific</h3>
<div class="paragraph">
<p>The processor API supports <code>ObjectMap</code> as well as any custom model. Intent is to support generic component
development which need to access configured "object paths" and specific components which rely on a well defined
path from the input.</p>
</div>
<div class="paragraph">
<p>A generic component would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyOutput onElement(ObjectMap input) {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A specific component would look like (with <code>MyInput</code> a POJO):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyOutput onElement(MyInput input) {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_no_runtime_assumption">1.4.1. No runtime assumption</h4>
<div class="paragraph">
<p>By design the framework must run in DI (plain standalone java program) but also in Beam pipelines. It is also
out of scope of the framework to handle the way the runtime serializes - if needed - the data. For that reason
it is primordial to not import serialization constraint in the stack. This is why <code>ObjectMap</code> is not an <code>IndexedRecord</code>
from avro for instance. Any serialization concern should either be hidden in the framework runtime (= outside component developer scope)
or in the runtime integration with the framework (beam integration for instance).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_isolated">2. Isolated</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The components must be able to execute even if they have conflicting libraries. For that purpose
it requires to isolate their classloaders. For that purpose a component will define
its dependencies based on a maven format and will always be bound to its own classloader.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rest">3. REST</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_consumable_model">3.1. Consumable model</h3>
<div class="paragraph">
<p>The definition payload is as flat as possible and <em>strongly</em> typed to ensure it can be manipulated by consumers.
This way the consumers can add/remove fields with just some mapping rules and don&#8217;t require any abstract tree handling.</p>
</div>
<div class="paragraph">
<p>The execution (runtime) configuration is the concatenation of a few framework metadata (only the version actually) and
a key/value model of the instance of the configuration based on the definition properties paths for the keys. This enables
the consumers to maintain and work with the keys/values up to their need.</p>
</div>
<div class="paragraph">
<p>The framework not being responsible for any persistence it is crucial to ensure consumers can handle it from end to end
which includes the ability to search for values (update a machine, update a port etc&#8230;&#8203;) and keys (new encryption rule on key <code>certificate</code> for instance).</p>
</div>
<div class="paragraph">
<p>Talend component is a metamodel provider (to build forms) and runtime <strong>execution</strong> platform (take a configuration instance and use it volatively
to execute a component logic). This implies it can&#8217;t own the data more than defining the contract it has for these two endpoints and must
let the consumers handle the data lifecycle (creation, encryption, deletion, &#8230;&#8203;.).</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_with_streaming">3.2. Execution with streaming</h3>
<div class="paragraph">
<p>A new mime type called <code>talend/stream</code> is introduced to define a streaming format.</p>
</div>
<div class="paragraph">
<p>It basically matches a JSON object per line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{<span style="color:#606"><span style="color:#404">&quot;</span><span>key1</span><span style="color:#404">&quot;</span></span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value1</span><span style="color:#710">&quot;</span></span>}
{<span style="color:#606"><span style="color:#404">&quot;</span><span>key2</span><span style="color:#404">&quot;</span></span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value2</span><span style="color:#710">&quot;</span></span>}
{<span style="color:#606"><span style="color:#404">&quot;</span><span>key1</span><span style="color:#404">&quot;</span></span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value11</span><span style="color:#710">&quot;</span></span>}
{<span style="color:#606"><span style="color:#404">&quot;</span><span>key1</span><span style="color:#404">&quot;</span></span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value111</span><span style="color:#710">&quot;</span></span>}
{<span style="color:#606"><span style="color:#404">&quot;</span><span>key2</span><span style="color:#404">&quot;</span></span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value2</span><span style="color:#710">&quot;</span></span>}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fixed_set_of_icons">4. Fixed set of icons</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Icons (<code>@Icon</code>) are based on a fixed set. Even if a custom icon is usable this is
without any guarantee. This comes from the fact components can be used in any environment
and require a kind of uniform look which can&#8217;t be guaranteed outside the UI itself so
defining only keys is the best way to communicate this information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
when you exactly know how you will deploy your component (ie in the Studio) then you
can use `@Icon(value = CUSTOM, custom = "&#8230;&#8203;") to use a custom icon file.
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_talend_component_documentation_overview" class="sect0">Talend Component Documentation Overview</h1>
<div class="sect1">
<h2 id="_getting_help">1. Getting help</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Talend Component framework is under the responsability of Mike Hirt team.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_first_steps">2. First steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you know nothing about Talend Components, the getting started is the place to start with.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>From scratch:</strong>
<a href="#getting-started-introducing-talend-component">Overview</a> |
<a href="#getting-started-system-requirements">Requirements</a></p>
</li>
<li>
<p><strong>Tutorial:</strong>
<a href="#getting-started-quick-start">Code</a> |
<a href="#getting-started-quick-start-run">Run</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_learning_about_talend_component_features">3. Learning about Talend Component features</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Core features:</strong>
<a href="#getting-started-introducing-talend-component">Overview</a> |
<a href="#getting-started-system-requirements">Requirements</a></p>
</li>
<li>
<p><strong>Advanced:</strong>
<a href="#documentation-testing-start">Testing</a></p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_talend_component_getting_started" class="sect0">Talend Component Getting Started</h1>
<div class="sect1">
<h2 id="getting-started-introducing-talend-component">1. Introducing Talend Component</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Talend Component</em> intends to simplify the development of connectors at two main levels:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Runtime</dt>
<dd>
<p>how to inject the specific component code into a job or pipeline. It should unify as much as possible the code required to run in DI and BEAM environments.</p>
</dd>
<dt class="hdlist1">Graphical interfaces</dt>
<dd>
<p>unify the code required to be able to render in a browser (web) or the eclipse based Studio (SWT).</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-system-requirements">2. Talend Component System Requirement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Talend Component requires Java 8. You can download it on <a href="http://www.oracle.com/technetwork/pt/java/javase/downloads/jdk8-downloads-2133151.html">Oracle</a> website.</p>
</div>
<div class="paragraph">
<p>To develop a component or the project itself it is recommanded to use Apache Maven 3.5.0. you can download it on <a href="https://maven.apache.org/download.cgi?Preferred=ftp%3A%2F%2Fmirror.reverse.net%2Fpub%2Fapache%2F">Apache Maven</a> website.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-first-quick-start">3. Quick Start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For our quick start, we&#8217;ll develop three components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one reading from a file and building <code>Person</code> records</p>
</li>
<li>
<p>one converting the <code>Person</code> in a <code>User</code> based on the incoming data and conventions</p>
</li>
<li>
<p>one writing the `User`s in a file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before we start checking how to implement it, let&#8217;s just have a quick look to our data structure (records):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Person</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">int</span> age;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">User</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> id;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> name;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can note these classes are <code>Serializable</code>. This is mainly for <code>BEAM</code> case but we&#8217;ll get back on this point later.</p>
</div>
<div class="sect2">
<h3 id="_dependencies">3.1. Dependencies</h3>
<div class="paragraph">
<p>To code a component the only needed dependency is the API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>component-api<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${project.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inputs">3.2. Inputs</h3>
<div class="paragraph">
<p>The inputs often require to open/close a connection and then just work on that connection.</p>
</div>
<div class="paragraph">
<p>Opening the connection can be done in a method decorated with <code>@PostConstruct</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PostConstruct</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> open() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">FileNotFoundException</span> {
    reader = service.createInput(file);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we have a <em>connection</em> we can read records. For our simple case we&#8217;ll just read a kind of CSV file containing per row the name and age of a <code>Person</code>.
This is done in a method dedicated to read <strong>next</strong> element which is decorated with <code>@Producer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Producer</span>
<span style="color:#088;font-weight:bold">public</span> Person readNext() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
    <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> line = reader.readLine();
    <span style="color:#080;font-weight:bold">if</span> (line == <span style="color:#069">null</span>) { <span style="color:#777">// end of the data is marked with null</span>
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">null</span>;
    }
    <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> info = line.split(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">;</span><span style="color:#710">&quot;</span></span>); <span style="color:#777">// poor csv parser</span>
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Person(info[<span style="color:#00D">0</span>], <span style="color:#0a8;font-weight:bold">Integer</span>.parseInt(info[<span style="color:#00D">1</span>].trim()));
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
if you need to rely on a buffer because you load multiple data at once you can reuse <code>org.talend.sdk.component.api.base.BufferizedProducerSupport</code> class
to implement your producer method.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally closing the connection once work was done (dataset was completely browsed) can be done in a method decorated with <code>@PreDestroy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PreDestroy</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> close() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
    <span style="color:#080;font-weight:bold">if</span> (reader != <span style="color:#069">null</span>) {
        reader.close();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
there is another type of input called <code>PartitionMapper</code> which allows to map (in the map/reduce sense) an input but it will be tackled later.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_a_processor">3.3. A Processor</h3>
<div class="paragraph">
<p>A processor is imply a task taking an input and converting it to another one. In our case it will just take a person and convert it to a user
which has a name copied form the person and an id generated from the name and age of the user.</p>
</div>
<div class="paragraph">
<p>Exactly as the input we just write you can use <code>@PostConstruct</code> and <code>@PreDestroy</code> if you need to do some initializations but a processor
also has a particular pair of methods to handle the flow lifecycle: <code>@BeforeGroup</code> and <code>@AfterGroup</code>. This is the same idea but it is to mark
smaller chunks of data. It is close to the idea we have of a batch but without any guarantee of the associated size.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
it is highly inspired from <code>BEAM</code> <code>bundles</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To get started we don&#8217;t need to be so advanced and just need to take a <code>Person</code> and return a <code>User</code> in a method. This can be done decorating
a method with <code>@ElementListener</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> User map(<span style="color:#088;font-weight:bold">final</span> Person person) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
    <span style="color:#080;font-weight:bold">if</span> (log.isDebugEnabled()) {
        log.debug(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Handling {}</span><span style="color:#710">&quot;</span></span>, person);
    }
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> User(generateId(person), person.getName());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_an_output">3.4. An output</h3>
<div class="paragraph">
<p>Now we read our <code>Person</code>, mapped it to a <code>User</code>, we just need to write back the <code>User</code> to another file.</p>
</div>
<div class="paragraph">
<p>To keep it simple we&#8217;ll do the symmetric operation of our input, i.e. writing a kind of CSV file representing the users.</p>
</div>
<div class="paragraph">
<p>How to implement an output then? An output is just a processor not returning any data.</p>
</div>
<div class="paragraph">
<p>Same as for our reader, we&#8217;ll define an open and close methods to handle the interaction with the output stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PostConstruct</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> open() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">FileNotFoundException</span> {
    writer = service.createOutput(file);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PreDestroy</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> close() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
    <span style="color:#080;font-weight:bold">if</span> (writer != <span style="color:#069">null</span>) {
        writer.close();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the method handling the write will just be an <code>@ElementListener</code> method returning <code>void</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> write(<span style="color:#088;font-weight:bold">final</span> User user) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
    writer.println(user.getId() + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">;</span><span style="color:#710">&quot;</span></span> + user.getName());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-components">3.5. Registering our components</h3>
<div class="paragraph">
<p>You probably noticed our components have some configuration. Typically the file related components take a <code>File</code> as configuration.
To make it work we need to add a <em>factory</em> for these instances which will link the user configuration to the instances.</p>
</div>
<div class="paragraph">
<p>This is simply done through the component constructor themselves. To instantiate a component, the framework will
select the constructor using the most <code>@Option</code> and if not the one with the most parameters.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
if your component needs to be serialized (like inputs, processors) don&#8217;t forget to ensure you match the java
serialization rules like for instance having a <code>protected</code> no-arg constructor if you have a parent which is not <code>Object</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each type of component has a specific marker annotation taking the name of the component as parameter to declare
a component and a <code>component</code> method to declare the name of the component family:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Emitter</code> for producers (inputs)</p>
</li>
<li>
<p><code>@Processor</code> for processors (output or not)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>component</code> is a way to group together (logically) components, for instance <code>FlatFile</code> can be used in <code>component</code> and
<code>reader</code>/<code>writer</code> as name to have a group of two components related to flat files.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The constructor is responsible to do the link between the configuration and the instance of the component.
The configuration is injected through its parameters. Each parameter is marked with <code>@Option</code> which enables you to define a name
to the parameter (if not the framework will use the reflection parameter name, ie <code>arg0</code>, <code>arg1</code>, <code>arg2</code>, &#8230;&#8203; if you didn&#8217;t activate the
<code>-parameters</code> flag at compile time or it will be the actual parameter name otherwise).</p>
</div>
<div class="paragraph">
<p>The instantiation mechanism will be explained in details later but for this sample we just need to know a <code>File</code> is a valid parameter type.</p>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-first-quick-start-run">3.6. Run the quick start example</h3>
<div class="paragraph">
<p>To run the code we just created you will need the runtime dependency of the framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>component-runtime-manager<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${talend-component-runtime.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you have access to the <code>ComponentManager</code> which handles the research of the components and their instantiation.
We&#8217;ll dig into the way it finds the plugins later but for our sample we just need to know that using the default constructor
the calling jar (the jar containing the Main) will be considered as a plugin if it has some components.</p>
</div>
<div class="paragraph">
<p>Now we have a component manager, we just need to build our execution chain. For that purpose we can use the <code>ExecutionChainBuilder</code>.
This builder provides a DSL enforcing you to configure the job (with a name and if the system properties can override each component configuration),
then the input and finally the chain of processors. Once we have that the builder can create a <code>Supplier&lt;ExecutionChain&gt;</code> you can call immediately
using <code>get()</code> then <code>execute()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (<span style="color:#088;font-weight:bold">final</span> ComponentManager manager = ComponentManager.instance()) {
    ExecutionChainBuilder
            .start()
            .withConfiguration(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SampleJob</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">true</span>)
            .fromInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">2</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {

                {
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/input.csv</span><span style="color:#710">&quot;</span></span>);
                }
            })
            .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())
            .toProcessor(<span style="color:#069">null</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {

                {
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
                }
            })
            .create(manager, plugin -&gt; <span style="color:#069">null</span>, <span style="color:#080;font-weight:bold">new</span> CountingSuccessListener(), <span style="color:#080;font-weight:bold">new</span> ToleratingErrorHandler(<span style="color:#00D">0</span>))
            .get()
            .execute();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now if you create a <code>/tmp/input.csv</code> containing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">normal;6
marilyn;36</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then if you run the previous <code>Main</code> you can check there is now a <code>/tmp/output.csv</code> containing as expected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">a6normal;normal
a36marilyn;marilyn</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_talend_component_documentation" class="sect0">Talend Component Documentation</h1>
<div class="sect1">
<h2 id="_components_definitions">1. Components Definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Talend Component framework relies on several primitive components.</p>
</div>
<div class="paragraph">
<p>They can all use <code>@PostConstruct</code> and <code>@PreDestroy</code> to initialize/release
some underlying resource at the beginning/end of the processing.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
in distributed environments class' constructor will be called on cluster manager node, methods annotated with
<code>@PostConstruct</code> and <code>@PreDestroy</code> annotations will be called on worker nodes. Thus, partition plan computation and pipeline task
will be performed on different nodes.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generated-deployment-diagram.png" alt="generated deployment diagram" width="490" height="392">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Created task consists of Jar file, containing class, which describes pipeline(flow) which should be processed in cluster.</p>
</li>
<li>
<p>During partition plan computation step pipeline is analyzed and split into stages. Cluster Manager node instantiates mappers/processors
gets estimated data size using mappers, splits created mappers according to the estimated data size. All instances are serialized and
sent to Worker nodes afterwards.</p>
</li>
<li>
<p>Serialized instances are received and deserialized, methods annotated with @PostConstruct annotation are called. After that,
pipeline execution is started. Processor&#8217;s @BeforeGroup annotated method is called before processing first element in chunk.
After processing number of records estimated as chunk size, Processor&#8217;s @AfterGroup annotated method called. Chunk size is calculated
depending on environment the pipeline is processed by. After pipeline is processed, methods annotated with @PreDestroy annotation are called.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generated-driver-processing-workflow.png" alt="generated driver processing workflow" width="330" height="266">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generated-worker-processing-workflow.png" alt="generated worker processing workflow" width="240" height="476">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
all framework managed methods <code>MUST</code> be public too. Private methods are ignored.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
in term of design the framework tries to be as declarative as possible but also to stay extensible
not using fixed interfaces or method signatures. This will allow to add incrementally new features of the underlying implementations.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_partitionmapper">1.1. PartitionMapper</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A <code>PartitionMapper</code> is a component able to split itself to
make the execution more efficient.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This concept is borrowed to big data world and useful only in this context (<code>BEAM</code> executions).
Overall idea is to divide the work before executing it to try to reduce the overall execution time.</p>
</div>
<div class="paragraph">
<p>The process is the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Estimate the size of the data you will work on. This part is often heuristic and not very precise.</p>
</li>
<li>
<p>From that size the execution engine (<em>runner</em> for beam) will request the mapper to split <em>itself</em> in <em>N</em> mappers with a subset of the overall work.</p>
</li>
<li>
<p>The <em>leaf</em> (final) mappers will be used as a <code>Producer</code> (actual reader) factory.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this kind of component <code>MUST</code> be <code>Serializable</code> to be distributable.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_definition">1.1.1. Definition</h4>
<div class="paragraph">
<p>A partition mapper requires 3 methods marked with specific annotations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@Assessor</code> for the evaluating method</p>
</li>
<li>
<p><code>@Split</code> for the dividing method</p>
</li>
<li>
<p><code>@Emitter</code> for the <code>Producer</code> factory</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_assessor">@Assessor</h5>
<div class="paragraph">
<p>The assessor method will return the estimated size of the data related to the component (depending its configuration).
It <code>MUST</code> return a <code>Number</code> and <code>MUST</code> not take any parameter.</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Assessor</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">long</span> estimateDataSetByteSize() {
    <span style="color:#080;font-weight:bold">return</span> ....;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_split">@Split</h5>
<div class="paragraph">
<p>The split method will return a collection of partition mappers and can take optionally a <code>@PartitionSize</code> long
value which is the requested size of the dataset per sub partition mapper.</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Split</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;MyMapper&gt; split(<span style="color:#007">@PartitionSize</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">long</span> desiredSize) {
    <span style="color:#080;font-weight:bold">return</span> ....;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_emitter">@Emitter</h5>
<div class="paragraph">
<p>The emitter method <code>MUST</code> not have any parameter and <code>MUST</code> return a producer. It generally uses the partition mapper configuration
to instantiate/configure the producer.</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Emitter</span>
<span style="color:#088;font-weight:bold">public</span> MyProducer create() {
    <span style="color:#080;font-weight:bold">return</span> ....;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_producer">1.2. Producer</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A<code>Producer</code> is the component interacting with a physical source. It produces input data for the processing flow.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>A producer is a very simple component which <code>MUST</code> have a <code>@Producer</code> method without any parameter and returning any data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Producer</span>
<span style="color:#088;font-weight:bold">public</span> MyData produces() {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_processor">1.3. Processor</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A <code>Processor</code> is a component responsible to convert an incoming data to another model.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>A processor <code>MUST</code> have a method decorated with <code>@ElementListener</code> taking an incoming data and returning the processed data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyNewData map(<span style="color:#088;font-weight:bold">final</span> MyData data) {
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this kind of component <code>MUST</code> be <code>Serializable</code> since it is distributed.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
if you don&#8217;t care much of the type of the parameter and need to access data on a "map like" based rule set, then you can
use <code>ObjectMap</code> as parameter type and Talend Component will just wrap the data to enable you to access it as a map. The parameter
type is not enforced, i.e. if you know you will get a <code>SuperCustomDto</code> then you can use that as parameter type but for generic
component reusable in any chain it is more than highly encouraged to use <code>ObjectMap</code> until you have your an evaluation language
based processor (which has its own way to access component). Here is an example:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyNewData map(<span style="color:#088;font-weight:bold">final</span> ObjectMap incomingData) {
    <span style="color:#0a8;font-weight:bold">String</span> name = <span style="color:#0a8;font-weight:bold">String</span>.class.cast(incomingData.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>));
    <span style="color:#339;font-weight:bold">int</span> name = <span style="color:#0a8;font-weight:bold">Integer</span>.class.cast(incomingData.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span>));
    <span style="color:#080;font-weight:bold">return</span> ...;
}

<span style="color:#777">// equivalent to (using POJO subclassing)</span>

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Person</span> {
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> age;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> age;

    <span style="color:#777">// getters/setters</span>
}

<span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyNewData map(<span style="color:#088;font-weight:bold">final</span> Person person) {
    <span style="color:#0a8;font-weight:bold">String</span> name = person.getName();
    <span style="color:#339;font-weight:bold">int</span> name = person.getAge();
    <span style="color:#080;font-weight:bold">return</span> ...;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A processor also supports <code>@BeforeGroup</code> and <code>@AfterGroup</code> which <code>MUST</code> be methods without parameters and returning <code>void</code> (result would be ignored).
This is used by the runtime to mark a chunk of the data in a way which is estimated <em>good</em> for the execution flow size.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this is estimated so you don&#8217;t have any guarantee on the size of a <em>group</em>. You can literally have groups of size 1.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The common usage is to batch records for performance reasons:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@BeforeGroup</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> initBatch() {
    <span style="color:#777">// ...</span>
}

<span style="color:#007">@AfterGroup</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> endBatch() {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
it is a good practise to support a <code>maxBatchSize</code> here and potentially commit before the end of the group in case
of a computed size which is way too big for your backend.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_objectmap_and_dynamic_schemas">1.3.1. ObjectMap and dynamic schemas</h4>
<div class="paragraph">
<p>If you don&#8217;t know at coding time the structure of your object you can use <code>@ObjectMap.Any</code> on a <code>Map&lt;String, Object&gt;</code> field
which means the <code>ObjectMap</code> mapping will use the (unique) decorated field to find any entry in the object.</p>
</div>
<div class="paragraph">
<p>For instance with this model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcRecord</span> {
    <span style="color:#007">@Any</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; columnValues;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the framework will be able to access any column:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Object</span> name = jdbcRecordObjectMap.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_outputs">1.4. Multiple outputs</h3>
<div class="paragraph">
<p>In some case you may want to split the output of a processor in two. A common example is "main" and "reject" branches
where part of the incoming data are put in a specific bucket to be processed later.</p>
</div>
<div class="paragraph">
<p>This can be done using <code>@Output</code>. This can be used as a replacement of the returned value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> map(<span style="color:#088;font-weight:bold">final</span> MyData data, <span style="color:#007">@Output</span> <span style="color:#088;font-weight:bold">final</span> OutputEmitter&lt;MyNewData&gt; output) {
    output.emit(createNewData(data));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can pass it a string which will represent the new branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> map(<span style="color:#088;font-weight:bold">final</span> MyData data,
                <span style="color:#007">@Output</span> <span style="color:#088;font-weight:bold">final</span> OutputEmitter&lt;MyNewData&gt; main,
                <span style="color:#007">@Output</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">rejected</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> OutputEmitter&lt;MyNewDataWithError&gt; rejected) {
    <span style="color:#080;font-weight:bold">if</span> (isRejected(data)) {
        rejected.emit(createNewData(data));
    } <span style="color:#080;font-weight:bold">else</span> {
        main.emit(createNewData(data));
    }
}

<span style="color:#777">// or simply</span>

<span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyNewData map(<span style="color:#088;font-weight:bold">final</span> MyData data,
                    <span style="color:#007">@Output</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">rejected</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> OutputEmitter&lt;MyNewDataWithError&gt; rejected) {
    <span style="color:#080;font-weight:bold">if</span> (isSuspicious(data)) {
        rejected.emit(createNewData(data));
        <span style="color:#080;font-weight:bold">return</span> createNewData(data); <span style="color:#777">// in this case we continue the processing anyway but notified another channel</span>
    }
    <span style="color:#080;font-weight:bold">return</span> createNewData(data);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_inputs">1.5. Multiple inputs</h3>
<div class="paragraph">
<p>Having multiple inputs is closeto the output case excep it doesn&#8217;t require a wrapper <code>OutputEmitter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> MyNewData map(<span style="color:#007">@Input</span> <span style="color:#088;font-weight:bold">final</span> MyData data, <span style="color:#007">@Input</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input2</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> MyData2 data2) {
    <span style="color:#080;font-weight:bold">return</span> createNewData(data1, data2);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@Input</code> takes the input name as parameter, if not set it uses the main (default) input branch.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
due to the work required to not use the default branch it is recommanded to use it when possible and not
name its branches depending on the component semantic.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_output">1.5.1. Output</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>An <code>Output</code> is a <code>Processor</code> returning no data.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Conceptually an output is a listener of data. It perfectly matches the concept of processor. Being the last of the execution chain
or returning no data will make your processor an output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ElementListener</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> store(<span style="color:#088;font-weight:bold">final</span> MyData data) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_combiners">1.6. Combiners?</h3>
<div class="paragraph">
<p>For now Talend Component doesn&#8217;t enable you to define a <code>Combiner</code>. It would be the symmetric part of the partition mapper
and allow to aggregate results in a single one.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_registering_components">2. Registering components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As seen in the <a href="#getting-started-first-quick-start">Getting Started</a>, you need an annotation to register
your component through <code>family</code> method. Multiple components can use the same <code>family</code> value but the pair <code>family</code>+<code>name</code>
<code>MUST</code> be unique for the system.</p>
</div>
<div class="paragraph">
<p>If you desire (recommended) to share the same component family name instead of repeating yourself in all <code>family</code> methods,
you can use <code>@Components</code> annotation on the root package of you component, it will enable you to define the component family and
the categories the component belongs to (default is <code>Misc</code> if not set). Here is a sample <code>package-info.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Components</span>(name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my_component_family</span><span style="color:#710">&quot;</span></span>, categories = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My Category</span><span style="color:#710">&quot;</span></span>)
<span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.talend.sdk.component.sample</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.talend.sdk.component.api.component.Components</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an existing component it can look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Components</span>(name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Salesforce</span><span style="color:#710">&quot;</span></span>, categories = {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Business</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Cloud</span><span style="color:#710">&quot;</span></span>})
<span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.talend.sdk.component.sample</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.talend.sdk.component.api.component.Components</span>;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_components_metadata">2.1. Components metadata</h3>
<div class="paragraph">
<p>Components can require a few metadata to be integrated in Talend Studio or Cloud platform. Here is how to provide these information.
These metadata are set on the component class and belongs to <code>org.talend.sdk.component.api.component</code> package.</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Icon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set an icon key used to represent the component. Note you can use a custom key with <code>custom()</code> method but it is not guaranteed the icon will be rendered properly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the component version, default to 1.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Icon</span>(FILE_XML_O)
<span style="color:#007">@PartitionMapper</span>(name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jaxbInput</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JaxbPartitionMapper</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_management_of_configuration_versions">2.1.1. Management of configuration versions</h4>
<div class="paragraph">
<p>If some impacting changes happen on the configuration they can be manage through a migration handler at <strong>component</strong> level (to enable
to support trans-model migration).</p>
</div>
<div class="paragraph">
<p>The <code>@Version</code> annotation supports a <code>migrationHandler</code> method which will take the implementation migrating the incoming configuration
to the current model.</p>
</div>
<div class="paragraph">
<p>For instance if <code>filepath</code> configuration entry from v1 changed to <code>location</code> in v2 you can remap the value to the right key in your
<code>MigrationHandler</code> implementation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
it is recommanded to not manage all migrations in the handler but rather split it in services you inject in the migration handler
(through constructor):
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// full component code structure skipped for brievity, kept only migration part</span>
<span style="color:#007">@Version</span>(value = <span style="color:#00D">3</span>, migrationHandler = MyComponent.Migrations.class)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyComponent</span> {
    <span style="color:#777">// the component code...</span>


    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">VersionConfigurationHandler</span> {
        <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; migrate(<span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; incomingData);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Migrations</span> {
        <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;VersionConfigurationHandler&gt; handlers;

        <span style="color:#777">// VersionConfigurationHandler implementations are decorated with @Service</span>
        <span style="color:#088;font-weight:bold">public</span> Migrations(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;VersionConfigurationHandler&gt; migrations) {
            <span style="color:#950">this</span>.handlers = migrations;
            <span style="color:#950">this</span>.handlers.sort(<span style="color:#777">/*some custom logic*/</span>);
        }

        <span style="color:#007">@Override</span>
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; migrate(<span style="color:#339;font-weight:bold">int</span> incomingVersion, <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; incomingData) {
            <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; out = incomingData;
            <span style="color:#080;font-weight:bold">for</span> (MigrationHandler handler : handlers) {
                out = handler.migrate(out);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What is important in this snippet is not much the way the code is organized but rather the fact you organize your migrations the way which fits the best
your component. If migrations are not conflicting no need of something fancy, just apply them all but if you need to apply them in order
you need to ensure they are sorted. Said otherwise: don&#8217;t see this API as a migration API but as a migration callback
and adjust the migration code structure you need behind the <code>MigrationHandler</code> based on your
component requirements. The service injection enables you to do so.</p>
</div>
</div>
<div class="sect3">
<h4 id="_partitionmapper_2">2.1.2. @PartitionMapper</h4>
<div class="paragraph">
<p><code>@PartitionMapper</code> will obviously mark a partition mapper:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">demo</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my_mapper</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyMapper</span> {
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_emitter_2">@Emitter</h5>
<div class="paragraph">
<p><code>@Emitter</code> is a shortcut for <code>@PartitionMapper</code> when you don&#8217;t support distribution. Said otherwise it will enforce an implicit
partition mapper execution with an assessor size of 1 and a split returning itself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Emitter</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">demo</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my_input</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyInput</span> {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processor_2">2.1.3. @Processor</h4>
<div class="paragraph">
<p>A method decorated with <code>@Processor</code> will be considered as a producer factory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Processor</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">demo</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my_processor</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyProcessor</span> {
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internationalization">3. Internationalization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recommanded practise for internationalization are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>store messages using <code>ResourceBundle</code> properties file in your component module</p>
</li>
<li>
<p>the location of the properties are in the same package than the related component(s) and is named <code>Messages</code> (ex: <code>org.talend.demo.MyComponent</code> will use <code>org.talend.demo.Messages[locale].properties</code>)</p>
</li>
<li>
<p>for your own messages use the internationalization API</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_internationalization_api">3.1. Internationalization API</h3>
<div class="paragraph">
<p>Overal idea is to design its messages as methods returning <code>String</code> values
and back the template by a <code>ResourceBundle</code> located in the same package than the interface
defining these methods and named <code>Messages</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this is the mecanism to use to internationalize your own messages in your own components.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To ensure you internationalization API is identified you need to mark it with <code>@Internationalized</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Internationalized</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Translator</span> {

    <span style="color:#0a8;font-weight:bold">String</span> message();

    <span style="color:#0a8;font-weight:bold">String</span> templatizedMessage(<span style="color:#0a8;font-weight:bold">String</span> arg0, <span style="color:#339;font-weight:bold">int</span> arg1); <i class="conum" data-value="2"></i><b>(2)</b>

    <span style="color:#0a8;font-weight:bold">String</span> localized(<span style="color:#0a8;font-weight:bold">String</span> arg0, <span style="color:#007">@Language</span> <span style="color:#0a8;font-weight:bold">Locale</span> locale); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Internationalized</code> allows to mark a class as a i18n service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>you can pass parameters and the message will use <code>MessageFormat</code> syntax to be resolved based on the <code>ResourceBundle</code> template</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>you can use <code>@Language</code> on a <code>Locale</code> parameter to specify manually the locale to use, note that a single value will be used (the first parameter tagged as such).</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_default_components_keys">3.2. Default components keys</h3>
<div class="paragraph">
<p>Out of the box components are internationalized using the same location logic for the resource bundle and here is the list
of supported keys:</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name Pattern</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">${family}._displayName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the display name of the family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">${family}.${configurationType}.${name}._displayName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the display name of a configuration type (dataStore or dataSet)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">${family}.${component_name}._displayName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the display name of the component (used by the GUIs)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">${property_path}._displayName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the display name of the option.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example of configuration for a component named <code>list</code> belonging to the family <code>memory</code> (<code>@Emitter(family = "memory", name = "list")</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>memory.list._displayName = Memory List</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_component_loading">4. Component loading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Talend Component scanning is based on a plugin concept. To ensure plugins can be developped in parallel and avoid conflicts
it requires to isolate plugins (components or component grouped in a single jar/plugin).</p>
</div>
<div class="paragraph">
<p>Here we have multiple options which are (high level):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>flat classpath: listed for completeness but rejected <em>by design</em> because it doesn&#8217;t match at all this requirement.</p>
</li>
<li>
<p>tree classloading: a shared classloader inherited by plugin classloaders but plugin classloader classes
are not seen by the shared classloader nor by other plugins.</p>
</li>
<li>
<p>graph classloading: this one allows you to link the plugins and dependencies together dynamically in any direction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to map it to concrete common examples, the tree classloading is commonly used by Servlet containers where plugins are web applications
and the graph classloading can be illustrated by OSGi containers.</p>
</div>
<div class="paragraph">
<p>In the spirit of avoiding a lot of complexity added by this layer, Talend Component relies on a tree classloading. The advantage
is you don&#8217;t need to define the relationship with other plugins/dependencies (it is built-in).</p>
</div>
<div class="paragraph">
<p>Here is a representation of this solution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generated-classloader-layout.png" alt="generated classloader layout" width="480" height="168">
</div>
</div>
<div class="paragraph">
<p>The interesting part is the <em>shared</em> area will contain Talend Component API which is the only (by default) shared classes accross the whole plugins.</p>
</div>
<div class="paragraph">
<p>Then each plugins will be loaded in their own classloader with their dependencies.</p>
</div>
<div class="sect2">
<h3 id="_packaging_a_plugin">4.1. Packaging a plugin</h3>
<div class="paragraph">
<p>A plugin is just a jar which was enriched with the list of its dependencies. By default Talend Component runtime is able to
read the output of <code>maven-dependency-plugin</code> in <code>TALEND-INF/dependencies.txt</code> location so you just need to ensure your component defines the following plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>maven-dependency-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>3.0.1<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>create-TALEND-INF/dependencies.txt<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>process-resources<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>list<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;outputFile&gt;</span>${project.build.outputDirectory}/TALEND-INF/dependencies.txt<span style="color:#070;font-weight:bold">&lt;/outputFile&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you check your jar once built you will see that the file contains something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ unzip -p target/mycomponent-1.0.0-SNAPSHOT.jar TALEND-INF/dependencies.txt

The following files have been resolved:
   org.talend.sdk.component:component-api:jar:1.0.0-SNAPSHOT:provided
   org.apache.geronimo.specs:geronimo-annotation_1.0_spec:jar:1.1.1:provided
   org.superbiz:awesome-project:jar:1.2.3:compile
   junit:junit:jar:4.12:test
   org.hamcrest:hamcrest-core:jar:1.3:test</code></pre>
</div>
</div>
<div class="paragraph">
<p>What is important to see is the scope associated to the artifacts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the API (<code>component-api</code> and <code>geronimo-annotation_1.0_spec</code>) are <code>provided</code> because you can consider them to be there when executing (it comes with the framework)</p>
</li>
<li>
<p>your specific dependencies (<code>awesome-project</code>) is <code>compile</code>: it will be included as a needed dependency by the framework (note that using <code>runtime</code> works too).</p>
</li>
<li>
<p>the other dependencies will be ignored (<code>test</code> dependencies)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_packaging_an_application">4.2. Packaging an application</h3>
<div class="paragraph">
<p>Even if a flat classpath deployment is possible, it is not recommanded because it would then reduce the capabilities of the components.</p>
</div>
<div class="sect3">
<h4 id="_dependencies_2">4.2.1. Dependencies</h4>
<div class="paragraph">
<p>The way the framework resolves dependencies is based on a local maven repository layout. As a quick reminder it looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>.
 groupId1
  artifactId1
      version1
       artifactId1-version1.jar
      version2
        artifactId1-version2.jar
 groupId2
   artifactId2
       version1
         artifactId2-version1.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is all the layout the framework will use. Concretely the logic will convert the t-uple {groupId, artifactId, version, type (jar)}
to the path in the repository.</p>
</div>
<div class="paragraph">
<p>Talend Component runtime has two ways to find an artifact:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>from the file system based on a configure maven 2 repository.</p>
</li>
<li>
<p>from a fatjar (uber jar) with a nested maven repository under <code>MAVEN-INF/repository</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first option will use either - by default - <code>${user.home}/.m2/repository</code> or a specific path configured when creating a <code>ComponentManager</code>.
The nested repository option will need some configuration during the packaging to ensure the repository is well created.</p>
</div>
<div class="sect4">
<h5 id="_create_a_nested_maven_repository_with_maven_shade_plugin">Create a nested maven repository with maven-shade-plugin</h5>
<div class="paragraph">
<p>To create the nested <code>MAVEN-INF/repository</code> repository you can use <code>nested-maven-repository</code> extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>maven-shade-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>3.0.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>package<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>shade<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;transformers&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;transformer</span> <span style="color:#b48">implementation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.container.maven.shade.ContainerDependenciesTransformer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;session&gt;</span>${session}<span style="color:#070;font-weight:bold">&lt;/project&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/transformer&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/transformers&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>nested-maven-repository<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${the.plugin.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_listing_needed_plugins">4.2.2. Listing needed plugins</h4>
<div class="paragraph">
<p>Plugin are programmatically registered in general but if you want to make some of them automatically available you
need to generate a <code>TALEND-INF/plugins.properties</code> which will map a plugin name to coordinates found with the maven mecanism
we just talked about.</p>
</div>
<div class="paragraph">
<p>Here again we can enrich <code>maven-shade-plugin</code> to do it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>maven-shade-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>3.0.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>package<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>shade<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;transformers&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;transformer</span> <span style="color:#b48">implementation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.container.maven.shade.PluginTransformer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;session&gt;</span>${session}<span style="color:#070;font-weight:bold">&lt;/project&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/transformer&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/transformers&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>nested-maven-repository<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${the.plugin.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_maven_shade_plugin_code_extensions">4.2.3. <code>maven-shade-plugin</code> extensions</h4>
<div class="paragraph">
<p>Here is a final job/application bundle based on maven shade plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>maven-shade-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>3.0.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;createDependencyReducedPom&gt;</span>false<span style="color:#070;font-weight:bold">&lt;/createDependencyReducedPom&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;filters&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;filter&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifact&gt;</span><strong>:</strong><span style="color:#070;font-weight:bold">&lt;/artifact&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;excludes&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;exclude&gt;</span>META-INF/<strong>.SF<span style="color:#070;font-weight:bold">&lt;/exclude&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;exclude&gt;</span>META-INF/</strong>.DSA<span style="color:#070;font-weight:bold">&lt;/exclude&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;exclude&gt;</span>META-INF/*.RSA<span style="color:#070;font-weight:bold">&lt;/exclude&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/excludes&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/filter&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/filters&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>package<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>shade<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;shadedClassifierName&gt;</span>shaded<span style="color:#070;font-weight:bold">&lt;/shadedClassifierName&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;transformers&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;transformer</span>
              <span style="color:#b48">implementation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.container.maven.shade.ContainerDependenciesTransformer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;session&gt;</span>${session}<span style="color:#070;font-weight:bold">&lt;/session&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;userArtifacts&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;artifact&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>sample-component<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;version&gt;</span>1.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;type&gt;</span>jar<span style="color:#070;font-weight:bold">&lt;/type&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;/artifact&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/userArtifacts&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/transformer&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;transformer</span> <span style="color:#b48">implementation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.container.maven.shade.PluginTransformer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;session&gt;</span>${session}<span style="color:#070;font-weight:bold">&lt;/session&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;userArtifacts&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;artifact&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>sample-component<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;version&gt;</span>1.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;type&gt;</span>jar<span style="color:#070;font-weight:bold">&lt;/type&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;/artifact&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/userArtifacts&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/transformer&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/transformers&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>nested-maven-repository-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${the.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the configuration unrelated to transformers can depend your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ContainerDependenciesTransformer</code> is the one to embed a maven repository and <code>PluginTransformer</code> to create a file listing (one per line)
a list of artifacts (representing plugins).</p>
</div>
<div class="paragraph">
<p>Both transformers share most of their configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>session</code>: must be set to <code>${session}</code>. This is used to retrieve dependencies.</p>
</li>
<li>
<p><code>scope</code>: a comma separated list of scope to include in the artifact filtering (note that the default will rely on <code>provided</code> but you can replace it by <code>compile</code>, <code>runtime</code>, <code>runtime+compile</code>, <code>runtime+system</code>, <code>test</code>).</p>
</li>
<li>
<p><code>include</code>: a comma separated list of artifact to include in the artifact filtering.</p>
</li>
<li>
<p><code>exclude</code>: a comma separated list of artifact to exclude in the artifact filtering.</p>
</li>
<li>
<p><code>userArtifacts</code>: a list of artifacts (groupId, artifactId, version, type - optional, file - optional for plugin transformer, scope - optional) which can be forced inline - mainly useful for<code>PluginTransformer</code>.</p>
</li>
<li>
<p><code>includeTransitiveDependencies</code>: should transitive dependencies of the components be included, true by default.</p>
</li>
<li>
<p><code>includeProjectComponentDependencies</code>: should project component dependencies be included, false by default (normally a job project uses isolation for components so this is not needed).</p>
</li>
<li>
<p><code>userArtifacts</code>: set of component artifacts to include.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
to use with the component tooling, it is recommended to keep default locations. Also if you feel you need to use project dependencies,
you can need to refactor your project structure to ensure you keep component isolation. Talend component let you handle that part but the recommended
practise is to use <code>userArtifacts</code> for the components and not the project <code>&lt;dependencies&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_containerdependenciestransformer">ContainerDependenciesTransformer</h5>
<div class="paragraph">
<p><code>ContainerDependenciesTransformer</code> specific configuration is the following one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>repositoryBase</code>: base repository location (default to <code>MAVEN-INF/repository</code>).</p>
</li>
<li>
<p><code>ignoredPaths</code>: a comma separated list of folder to not create in the output jar, this is common for the ones already created by other transformers/build parts.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_plugintransformer">PluginTransformer</h5>
<div class="paragraph">
<p><code>ContainerDependenciesTransformer</code> specific configuration is the following one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pluginListResource</code>: base repository location (default to TALEND-INF/plugins.properties`).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example: if you want to list only the plugins you use you can configure this transformer like that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;transformer</span> <span style="color:#b48">implementation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.container.maven.shade.PluginTransformer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;session&gt;</span>${session}<span style="color:#070;font-weight:bold">&lt;/session&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;include&gt;</span>org.talend.sdk.component:component-x,org.talend.sdk.component:component-y,org.talend.sdk.component:component-z<span style="color:#070;font-weight:bold">&lt;/include&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/transformer&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_component">5. Configuring component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Component are configured through their constructor parameters. They can all be marked with <code>@Option</code>
which will let you give a name to parameters (if not it will use the bytecode name which can require you to compile with <code>-parameter</code> flag
to not have <code>arg0</code>, <code>arg1</code>, &#8230;&#8203; as names).</p>
</div>
<div class="paragraph">
<p>The parameter types can be <em>primitives</em> or complex objects with fields decorated with <code>@Option</code> exactly like method parameters.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
it is recommanded to use simple models which can be serialized by components to avoid headaches when implementing serialized components.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FileFormat</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
    <span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">type</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> FileType type = FileType.CSV;

    <span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">max-records</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> maxRecords = <span style="color:#00D">1024</span>;
}

<span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">demo</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file-reader</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> MyFileReader(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file-path</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">File</span> file,
                    <span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file-format</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> FileFormat format) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this kind of API makes the configuration extensible and component oriented letting the user define all he needs.</p>
</div>
<div class="paragraph">
<p>The instantiation of the parameters is done from the properties passed to the component (see next part).</p>
</div>
<div class="sect2">
<h3 id="_primitives">5.1. Primitives</h3>
<div class="paragraph">
<p>What is considered as a primitive in this mecanism is a class which can be directly converted from a <code>String</code> to the expected type.</p>
</div>
<div class="paragraph">
<p>It obviously includes all java primitives, <code>String</code> type itself but also all the types with a <code>org.apache.xbean.propertyeditor.Converter</code>.</p>
</div>
<div class="paragraph">
<p>This includes out of the box:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BigDecimal</code></p>
</li>
<li>
<p><code>BigInteger</code></p>
</li>
<li>
<p><code>File</code></p>
</li>
<li>
<p><code>InetAddress</code></p>
</li>
<li>
<p><code>ObjectName</code></p>
</li>
<li>
<p><code>URI</code></p>
</li>
<li>
<p><code>URL</code></p>
</li>
<li>
<p><code>Pattern</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_complex_object_mapping">5.2. Complex object mapping</h3>
<div class="paragraph">
<p>The conversion from properties to object is using the dotted notation. For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">file.path = /home/user/input.csv
file.format = CSV</code></pre>
</div>
</div>
<div class="paragraph">
<p>will match</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FileOptions</span> {
    <span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">path</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">File</span> path;

    <span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Format</span> format;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>assuming the method parameter was configured with <code>@Option("file")</code>.</p>
</div>
<div class="sect3">
<h4 id="_list_case">5.2.1. List case</h4>
<div class="paragraph">
<p>Lists use the same syntax but to define their elements their rely on an indexed syntax. Assuming the list parameter is named <code>files</code>
and the elements are of <code>FileOptions</code> type, here is how to define a list of 2 elements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">files[0].path = /home/user/input1.csv
files[0].format = CSV
files[1].path = /home/user/input2.xml
files[2].format = EXCEL</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_map_case">5.2.2. Map case</h4>
<div class="paragraph">
<p>Inspired from the list case, the map uses <code>.key[index]</code> and <code>.value[index]</code> to represent its key and values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">// Map&lt;String, FileOptions&gt;
files.key[0] = first-file
files.value[0].path = /home/user/input1.csv
files.value[0].type = CSV
files.key[1] = second-file
files.value[1].path = /home/user/input2.xml
files.value[1].type = EXCEL</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">// Map&lt;FileOptions, String&gt;
files.key[0].path = /home/user/input1.csv
files.key[0].type = CSV
files.value[0] = first-file
files.key[1].path = /home/user/input2.xml
files.key[1].type = EXCEL
files.value[1] = second-file</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
don&#8217;t abuse of map type. If not needed for your configuration (= if you can configure your component
with an object) don&#8217;t use it.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constraints_and_validation_on_the_configuration_input">5.3. Constraints and validation on the configuration/input</h3>
<div class="paragraph">
<p>It is common to need to add as metadata a field is required, another has a minimum size etc. This is done with the
validation in <code>org.talend.sdk.component.api.configuration.constraint</code> package:</p>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Parameter Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Supported Types</th>
<th class="tableblock halign-left valign-top">Metadata sample</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxLength</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a higher bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CharSequence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::maxLength":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minLength</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a lower bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CharSequence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::minLength":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validate the decorated string with a java pattern, you can use xregex library in javascript.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CharSequence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::pattern":"test"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a higher bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number, int, short, byte, long, double, float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::max":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a lower bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number, int, short, byte, long, double, float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::min":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark the field as being mandatory.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::required":"true"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxItems</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a higher bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::maxItems":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minItems</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the decorated option size is validated with a lower bound.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::minItems":"12.34"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.constraint.Uniques</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqueItems</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure the elements of the collection must be distinct (kind of set).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"validation::uniqueItems":"true"}</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
using the programmatic API the metadata are prefixed by <code>tcomp::</code> but this prefix is stripped in the web for convenience,
the previous table uses the web keys.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_marking_a_configuration_as_a_particular_type_of_data">5.4. Marking a configuration as a particular type of data</h3>
<div class="paragraph">
<p>It is common to classify the incoming data. You can see it as tagging them in several types. The most common ones
are the:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>datastore: all the data you need to connect to the backend</p>
</li>
<li>
<p>dataset: a datastore coupled with all the data you need to execute an action</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Metadata sample</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.talend.sdk.component.api.configuration.type.DataStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">datastore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a model (complex object) as being a datastore (connection to a backend).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"tcomp::configurationtype::type":"datastore","tcomp::configurationtype::name":"test"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.talend.sdk.component.api.configuration.type.DataSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dataset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a model (complex object) as being a dataset.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"tcomp::configurationtype::type":"dataset","tcomp::configurationtype::name":"test"}</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
the component family associated with a configuration type (datastore/dataset) is always the one related
to the component using that configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Those configuration types can be composed to provide one configuration item. For example a dataset type will often need a datastore
type to be provided. and a datastore type (that provides the connection information) will be used to create a dataset type.</p>
</div>
<div class="paragraph">
<p>Those configuration types will also be used at design time to create shared configuration that can be stored and used at runtime.</p>
</div>
<div class="paragraph">
<p>For example, we can think about a relational database that support JDBC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A datastore may provide:</p>
<div class="ulist">
<ul>
<li>
<p>jdbc url, username, password</p>
</li>
</ul>
</div>
</li>
<li>
<p>A dataset may be:</p>
<div class="ulist">
<ul>
<li>
<p>datastore (that will provide the connection data to the database)</p>
</li>
<li>
<p>table name, data []</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The component server will scan all those configuration types and provide a configuration type index. This index can be used for the integration
into the targeted platforms (studio, web applications&#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>The configuration type index is represented as a flat tree that contains all the configuration types represented as nodes and indexed by their ids.</p>
</div>
<div class="paragraph">
<p>Also, every node can point to other nodes. This relation is represented as an array of edges that provide the childes ids.</p>
</div>
<div class="paragraph">
<p>For example, a configuration type index for the above example will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">s</span>: {
             <span style="color:#606"><span style="color:#404">&quot;</span><span>idForDstore</span><span style="color:#404">&quot;</span></span>: { <span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">e</span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">datastore data</span><span style="color:#710">&quot;</span></span>, <span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">g</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">s</span>:[<span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">d</span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">idForDset</span><span style="color:#710">&quot;</span></span>] },
             <span style="color:#606"><span style="color:#404">&quot;</span><span>idForDset</span><span style="color:#404">&quot;</span></span>:   { <span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">t</span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataset data</span><span style="color:#710">&quot;</span></span> }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_define_links_between_properties">5.5. Define links between properties</h3>
<div class="paragraph">
<p>It can be needed to define a binding between properties, a set of annotations allows to do it:</p>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Metadata Sample</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.condition.ActiveIf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the evaluation of the element at the location matches value then the element is considered active, otherwise it is deactivated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"condition::if::target":"test","condition::if::value":"value1,value2"}</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
using the programmatic API the metadata are prefixed by <code>tcomp::</code> but this prefix is stripped in the web for convenience,
the previous table uses the web keys.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="documentation-ui-hints">5.6. Add hints about the rendering based on configuration/component knowledge</h3>
<div class="paragraph">
<p>In some case it can be needed to add some metadata about the configuration to let the UI render properly the configuration.
A simple example is a password value must be hidden and not a simple clear input box. For these cases - when the component developper
wants to influence the UI rendering - you can use a particular set of annotations:</p>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Generated property metadata</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.DefaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provide a default value the UI can use - only for primitive fields.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::defaultvalue::value":"test"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.OptionsOrder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to sort a class properties.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::optionsorder::value":"value1,value2"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.layout.AutoLayout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request the rendered to do what it thinks is best.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::autolayout":"true"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.layout.GridLayout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced layout to place properties by row, this is exclusive with <code>@OptionsOrder</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::gridlayout::value1::value":"first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">second,third","ui::gridlayout::value2::value":"first</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">second,third"}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.layout.GridLayouts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow to configure multiple grid layouts on the same class, qualified with a classifier (name)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::gridlayout::Advanced::value":"another","ui::gridlayout::Main::value":"first</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">second,third"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.layout.HorizontalLayout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Put on a configuration class it notifies the UI an horizontal layout is preferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::horizontallayout":"true"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.layout.VerticalLayout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Put on a configuration class it notifies the UI a vertical layout is preferred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::verticallayout":"true"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.widget.Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a field as being represented by some code widget (vs textarea for instance).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::code::value":"test"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.widget.Credential</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a field as being a credential. It is typically used to hide the value in the UI.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::credential":"true"}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.configuration.ui.widget.TextArea</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a field as being represented by a textarea(multiline text input).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"ui::textarea":"true"}</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
using the programmatic API the metadata are prefixed by <code>tcomp::</code> but this prefix is stripped in the web for convenience,
the previous table uses the web keys.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
target support should cover <code>org.talend.core.model.process.EParameterFieldType</code> but we need to ensure web renderers is able to handle the same widgets.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_providing_some_actions_for_consumers_clients">6. Providing some actions for consumers/clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some cases you will desire to add some actions unrelated to the runtime. A simple example
is to enable clients - the users of the plugin/library - to test if a connection works. Even more concretely: <em>does my database is up?</em>.</p>
</div>
<div class="paragraph">
<p>To do so you need to define an <code>@Action</code> which is a method with a name (representing the event name) in a class decorated with <code>@Service</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyDbTester</span> {
    <span style="color:#007">@Action</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mycomp</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Status doTest(<span style="color:#088;font-weight:bold">final</span> IncomingData data) {
        <span style="color:#080;font-weight:bold">return</span> ...;
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
services are singleton so if you need some thread safety ensure they match that requirement. They
shouldn&#8217;t store any state too (state is held by the component) since they can be serialized any time.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
services are usable in components as well (matched by type) and allow to reuse some shared logic like a client. Here is a sample
with a service used to access files:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Emitter</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PersonReader</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
    <span style="color:#777">// attributes skipped to be concise</span>

    <span style="color:#088;font-weight:bold">public</span> PersonReader(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">File</span> file,
                        <span style="color:#088;font-weight:bold">final</span> FileService service) {
        <span style="color:#950">this</span>.file = file;
        <span style="color:#950">this</span>.service = service;
    }

    <span style="color:#777">// use the service</span>
    <span style="color:#007">@PostConstruct</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> open() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">FileNotFoundException</span> {
        reader = service.createInput(file);
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
service is passed to constructor automatically, it can be used as a bean. Only call of service&#8217;s method is required.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_particular_action_types">6.1. Particular action types</h3>
<div class="paragraph">
<p>Some actions are that common and need a clear contract so they are defined as API first citizen, this is the case for wizards or healthchecks
for instance. Here is the list of all actions:</p>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Return type</th>
<th class="tableblock halign-left valign-top">Sample returned type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.completion.DynamicValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dynamic_values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a method as being useful to fill potential values of a string option for a property denoted by its value. You can link a field as being completable using @Proposable(value). The resolution of the completion action is then done through the component family and value of the action. The callback doesn&#8217;t take any parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"items":[{"id":"value","label":"label"}]}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.healthcheck.HealthCheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">healthcheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This class marks an action doing a connection test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HealthCheckStatus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"comment":"Something went wrong","status":"KO"}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.schema.DiscoverSchema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark an action as returning a discovered schema. Its parameter MUST be the type decorated with <code>@Discoverable</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"entries":[{"name":"column1","type":"STRING"}]}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.asyncvalidation.AsyncValidation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a method as being used to validate a configuration. IMPORTANT: this is a server validation so only use it if you can&#8217;t use other client side validation to implement it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ValidationResult</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"comment":"Something went wrong","status":"KO"}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.wizard.Wizard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wizard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This class marks an action taking N parameters representing N screens (sorted) to do an action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_execution_chain_or_pipeline">7. Creating an execution chain or pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are two kind of chains the framework supports:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>standalone chains</p>
</li>
<li>
<p><a href="https://beam.apache.org/">Beam</a> chains</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_standalone_chains">7.1. Standalone chains</h3>
<div class="paragraph">
<p>For now the standalone chains only support linear flows (more to come) and are built based on a <code>ExecutionChainBuilder</code>.</p>
</div>
<div class="paragraph">
<p>This one will take some metadata about the flow (which input with which configuration, which processors, which processor order and configuration&#8230;&#8203;)
and will execute it linearly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExecutionChainBuilder.start()
        .withConfiguration(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SampleJob</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">true</span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .withInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/input.csv</span><span style="color:#710">&quot;</span></span>);
        }})
        .toProcessor(<span style="color:#069">null</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">2</span>, emptyMap()) <i class="conum" data-value="2"></i><b>(2)</b>
        .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reject</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
        }}).getParent()
        .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reject</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
        }})
        .create(manager, plugin -&gt; <span style="color:#069">null</span>, <span style="color:#080;font-weight:bold">new</span> CountingSuccessListener(), <span style="color:#080;font-weight:bold">new</span> ToleratingErrorHandler(<span style="color:#00D">0</span>)) <i class="conum" data-value="3"></i><b>(3)</b>
        .get()
        .execute(); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can configure some global execution configuration, like giving it a name and if system properties can override the component configuration
using <code>&lt;component group name&gt;.&lt;component name&gt;.&lt;configuration property name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Each component is registered from its component name (what is passed in <code>family</code> of the component annotation),
its own name (<code>name</code> method of the annotation) and its configuration as a map (2).</p>
</div>
<div class="paragraph">
<p>Once the flow is defined (there is no more processor after), then you can create the <code>ExecutionChain</code> (3) with its success/error listeners
to handle it in a custom manner and finally you can get it and execute the flow/pipeline (4).</p>
</div>
<div class="paragraph">
<p>A chain needs a <code>ComponentManager</code> which is the manager of the plugins. The easiest is to use its default constructor to create one instance.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this manager needs to be closed when no more needed so don&#8217;t forget to call close.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is a sample code for the previous chain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#088;font-weight:bold">final</span> ComponentManager manager = ComponentManager.instance()
        ExecutionChainBuilder.start()
                .withConfiguration(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SampleJob</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">true</span>)
                .fromInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/input.csv</span><span style="color:#710">&quot;</span></span>);
                }})
                .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">rejected</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())
                .getParent()
                .toProcessor(Branches.DEFAULT_BRANCH, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())
                .toProcessor(Branches.DEFAULT_BRANCH, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">3</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
                }})
                .create(manager, plugin -&gt; <span style="color:#069">null</span>, <span style="color:#080;font-weight:bold">new</span> CountingSuccessListener(), <span style="color:#080;font-weight:bold">new</span> ToleratingErrorHandler(<span style="color:#00D">0</span>))
                .get()
                .execute();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this API is not very powerful but allows to test simple cases, you can have a look to beam direct runner and the Talend Component beam bridge
for more advanced cases.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
the number before the configuration (map) is the version of this configuration, it allows to automatically migrate
from a version to the currently available one when needed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_beam_case">7.2. Beam case</h3>
<div class="paragraph">
<p>For beam case, you need to rely on beam pipeline definition and use <code>component-runtime-beam</code> dependency which provides Beam bridges.</p>
</div>
<div class="sect3">
<h4 id="_i_o">7.2.1. I/O</h4>
<div class="paragraph">
<p><code>org.talend.sdk.component.runtime.beam.TalendIO</code> provides a way to convert a partition mapper or a processor to an input or processor
using the <code>read</code> or <code>write</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#088;font-weight:bold">final</span> ComponentManager manager = ComponentManager.instance()
        Pipeline pipeline = Pipeline.create();
        <span style="color:#777">//Create beam input from mapper and apply input to pipeline</span>
        pipeline.apply(TalendIO.read(manager.findMapper(manager.findMapper(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fileprefix</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input</span><span style="color:#710">&quot;</span></span>);
                }}).get()))
                .apply(<span style="color:#080;font-weight:bold">new</span> ViewsMappingTransform&lt;&gt;(emptyMap())) <span style="color:#777">// prepare it for the output record format (see next part)</span>
        <span style="color:#777">//Create beam processor from talend processor and apply to pipeline</span>
                .apply(TalendIO.write(manager.findProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fileprefix</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">output</span><span style="color:#710">&quot;</span></span>);
                }}).get(), emptyMap()));

        <span style="color:#777">//... run pipeline</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processors">7.2.2. Processors</h4>
<div class="paragraph">
<p><code>org.talend.sdk.component.runtime.beam.TalendFn</code> provides the way to wrap a processor in a Beam <code>PTransform</code> and integrate it in the pipeline.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#777">//Component manager and pipeline initialization...</span>

        <span style="color:#777">//Create beam PTransform from processor and apply input to pipeline</span>
        pipeline.apply(TalendFn.asFn(manager.findProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())).get())), emptyMap());

        <span style="color:#777">//... run pipeline</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The multiple inputs/outputs are represented by a <code>Map</code> element in beam case to avoid to use multiple inputs/outputs.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can use <code>ViewsMappingTransform</code> or <code>CoGroupByKeyResultMappingTransform</code> to adapt the input/output
format to this <code>Map&lt;String, List&lt;Serializable&gt;&gt;</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_deployment">7.2.3. Deployment</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Beam serializing components it is crucial to add <code>component-runtime-standalone</code> dependency to the project. It will take
care of providing an implicit and lazy <code>ComponentManager</code> managing the component in a fatjar case.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_convert_a_beam_io_in_a_component_i_o">7.2.4. Convert a Beam.io in a component I/O</h4>
<div class="paragraph">
<p>For simple I/O you can get automatic conversion of the Beam.io to a component I/O transparently if you decorated your <code>PTransform</code>
with <code>@PartitionMapper</code> or <code>@Processor</code>.</p>
</div>
<div class="paragraph">
<p>The limitation are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inputs must implement <code>PTransform&lt;PBegin, PCollection&lt;?&gt;&gt;</code> and must be a <code>BoundedSource</code>.</p>
</li>
<li>
<p>Outputs must implement <code>PTransform&lt;PCollection&lt;?&gt;, PDone&gt;</code> and just register on the input <code>PCollection</code> a <code>DoFn</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information on that topic on <a href="#">How to wrap a Beam I/O</a> page.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_plugin">8. Maven Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>talend-component-maven-plugin</code> intends to help you to write components
validating components match best practices and also generating transparently metadata used by Talend Studio.</p>
</div>
<div class="paragraph">
<p>Here is how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>talend-component-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_validate">8.1. Validate</h3>
<div class="paragraph">
<p>The first goal is here to help you to validate the common programming model of the component. Here is the execution definition to activate it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>talend-component-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>talend-component-validate<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>validate<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default it will be bound to <code>process-classes</code> phase. When executing it will do several validations which can be switched off
adding the corresponding flags to <code>false</code> in the <code>&lt;configuration&gt;</code> block of the execution:</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateInternationalization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validates resource bundle are presents and contain commonly used keys (like <code>_displayName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateModel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure components pass validations of the <code>ComponentManager</code> and Talend Component runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateSerializable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure components are <code>Serializable</code> - note this is a sanity check, the component is not actually serialized here, if you have a doubt ensure to test it. It also checks any <code>@Internationalized</code> class is valid and has its keys.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateMetadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure components define an <code>@Icon</code> and <code>@Version</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateDataStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure any  <code>@DataStore</code> defines a <code>@HealthCheck</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateComponent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure native programming model is respected, you can disable it when using another programming model like in beam case.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateActions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validate actions signatures for the ones not tolerating dynamic binding (<code>@HealthCheck</code>, <code>@DynamicValues</code>, &#8230;&#8203;). It is recommanded to keep it <code>true</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validateFamily</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validate the family, i.e. the package containing the <code>@Components</code> has also a <code>@Icon</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_prepare">8.2. Prepare</h3>
<div class="paragraph">
<p>The <code>prepare</code> goal is to build artifacts you can deploy out of the box into the studio. It is a temporarly phase
until the framework programming model is fully integrated in Talend suite.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>talend-component-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>talend-component-prepare<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>prepare<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It will generate a maven project in <code>${project.build.directory}/oldtcomponentbridgemojo_workdir</code> which contains the artifacts
you can deploy to the studio. Here is the associated configuration:</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">attach the built virtual artifacts (definition and runtime modules) to the build/project (enables to deploy them)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">componentNgApiVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The component API version, if set to <code>auto</code> uses the one of the plugin (recommanded)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">componentsApiVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The bridge component API version, if set to <code>auto</code> uses the one of the plugin (recommanded)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">studioHome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set and <code>attach</code> is true, the created component will be installed in the studio located at that path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
if you configure a <code>studio</code> profile in your ~/.m2/settings.xml, you can activate/deactivate the deployment into the studio of your component
with a profile (adding <code>-Pstudio</code> to you build command, ex: <code>mvn clean install -Pstudio</code>). Here is a sample declaration of such a profile:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;profile&gt;</span> <span style="color:#777">&lt;!-- to deploy in the studio at build time: mvn clean install -Pstudio --&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;id&gt;</span>studio<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;properties&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;talend.component.studioHome&gt;</span>/opt/talend/TOS_DI-V6.5.0<span style="color:#070;font-weight:bold">&lt;/talend.component.studioHome&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/properties&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/profile&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generate_inputs_or_outputs">8.3. Generate inputs or outputs</h3>
<div class="paragraph">
<p>The Mojo <code>generate</code> (maven plugin goal) of the same plugin also embeds a generator you can use to bootstrap any input or output component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>talend-component-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${talend-component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>generate-input<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>generate-sources<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>generate<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;type&gt;</span>input<span style="color:#070;font-weight:bold">&lt;/type&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;execution&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>generate-output<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;phase&gt;</span>generate-sources<span style="color:#070;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;goal&gt;</span>generate<span style="color:#070;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;type&gt;</span>output<span style="color:#070;font-weight:bold">&lt;/type&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/executions&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Generates an input (partition mapper + emitter)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Generates an output</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is intended to be used from the command line (or IDE Maven integration):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ mvn talend-component:generate \
    -Dtalend.generator.type=[input|output] \ <i class="conum" data-value="1"></i><b>(1)</b>
    [-Dtalend.generator.classbase=com.test.MyComponent] \ <i class="conum" data-value="2"></i><b>(2)</b>
    [-Dtalend.generator.family=my-family] \ <i class="conum" data-value="3"></i><b>(3)</b>
    [-Dtalend.generator.pom.read-only=false] <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>select the type of component you want, <code>input</code> to generate a mapper and emitter and <code>output</code> to generate an output processor</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>set the class name base (will be suffixed by the component type), if not set the package will be guessed and classname based on the basedir name</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>set the component family to use, default to the base dir name removing (component[s] from the name, ex: <code>my-component</code> will lead to <code>my</code> as family if not explicitly set)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>should the generator try to add <code>component-api</code> in the pom if not already here, if you added it you can set it to <code>false</code> directly in the pom</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For this command to work you will need to just register the plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>talend-component-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${talend-component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_define_a_custom_api">9. Advanced: define a custom API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to extend the Component API for custom front features.</p>
</div>
<div class="paragraph">
<p>What is important here is to keep in mind you should do it
only if it targets not portable components (only used by the Studio or Beam).</p>
</div>
<div class="paragraph">
<p>In term of organization it is recommanded to create a custom <code>xxxx-component-api</code> module with the new set of annotations.</p>
</div>
<div class="sect2">
<h3 id="_extending_the_ui">9.1. Extending the UI</h3>
<div class="paragraph">
<p>To extend the UI just add an annotation which can be put on <code>@Option</code> fields which is decorated with <code>@Ui</code>.
All its members will be put in the metadata of the parameter. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Ui</span>
<span style="color:#007">@Target</span>(TYPE)
<span style="color:#007">@Retention</span>(RUNTIME)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> MyLayout {
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_talend_component_documentation_testing" class="sect0">Talend Component Documentation Testing</h1>
<div class="sect1">
<h2 id="documentation-testing-start">1. Best practises</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this part is mainly around tools usable with JUnit. You can use most of these techniques with TestNG
as well, check out the documentation if you need to use TestNG.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_parameterized_tests">1.1. Parameterized tests</h3>
<div class="paragraph">
<p>This is a great solution to repeat the same test multiple times. Overall idea
is to define a test scenario (<code>I test function F</code>) and to make the input/output data
dynamic.</p>
</div>
<div class="paragraph">
<p>Here is an example. Let&#8217;s assume we have this test which validates the connection URI using <code>ConnectionService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConnectionURITest</span> {
    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> checkMySQL() {
        assertTrue(<span style="color:#080;font-weight:bold">new</span> ConnectionService().isValid(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:mysql://localhost:3306/mysql</span><span style="color:#710">&quot;</span></span>));
    }

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> checkOracle() {
        assertTrue(<span style="color:#080;font-weight:bold">new</span> ConnectionService().isValid(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:oracle:thin:@//myhost:1521/oracle</span><span style="color:#710">&quot;</span></span>));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We clearly identify the test method is always the same except the value. It can therefore be rewritter
using JUnit <code>Parameterized</code> runner like that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@RunWith</span>(Parameterized.class) <i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConnectionURITest</span> {

    <span style="color:#007">@Parameterized</span>.Parameters(name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">{0}</span><span style="color:#710">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#0a8;font-weight:bold">Iterable</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; uris() { <i class="conum" data-value="3"></i><b>(3)</b>
        <span style="color:#080;font-weight:bold">return</span> asList(
            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:mysql://localhost:3306/mysql</span><span style="color:#710">&quot;</span></span>,
            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:oracle:thin:@//myhost:1521/oracle</span><span style="color:#710">&quot;</span></span>);
    }

    <span style="color:#007">@Parameterized</span>.Parameter <i class="conum" data-value="4"></i><b>(4)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> uri;

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> isValid() { <i class="conum" data-value="5"></i><b>(5)</b>
        assertNotNull(uri);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Parameterized</code> is the runner understanding <code>@Parameters</code> and how to use it. Note that you can generate random data here if desired.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>by default the name of the executed test is the index of the data, here we customize it using the first parameter <code>toString()</code> value to have something more readable</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the <code>@Parameters</code> method <code>MUST</code> be static and return an array or iterable of the data used by the tests</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>you can then inject the current data using <code>@Parameter</code> annotation, it can take a parameter if you use an array of array instead of an iterable of object in <code>@Parameterized</code> and you can select which item you want injected this way</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>the <code>@Test</code> method will be executed using the contextual data, in this sample we&#8217;ll get executed twice with the 2 specified urls</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you don&#8217;t have to define a single <code>@Test</code> method, if you define multiple, each of them will be executed with all the data (ie if we add a test in previous example you will get 4 tests execution - 2 per data, ie 2x2)
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_component_runtime_testing">2. component-runtime-testing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_component_runtime_junit">2.1. component-runtime-junit</h3>
<div class="paragraph">
<p><code>component-runtime-junit</code> is a small test library allowing you to validate simple logic based on Talend Component tooling.</p>
</div>
<div class="paragraph">
<p>To import it add to your project the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>component-runtime-junit<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${talend-component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;scope&gt;</span>test<span style="color:#070;font-weight:bold">&lt;/scope&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can define a standard JUnit test and use the <code>SimpleComponentRule</code> rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyComponentTest</span> {

    <span style="color:#007">@Rule</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> SimpleComponentRule components = <span style="color:#080;font-weight:bold">new</span> SimpleComponentRule(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.mycomponent.</span><span style="color:#710">&quot;</span></span>);

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> produce() {
        ExecutionChainBuilder.start() <i class="conum" data-value="2"></i><b>(2)</b>
                .fromInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yourcomponentfamily</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yourcomponent</span><span style="color:#710">&quot;</span></span>, createComponentConfig())
                .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">collector</span><span style="color:#710">&quot;</span></span>, emptyMap())
                .create(components.asManager(), p -&gt; <span style="color:#069">null</span>, Assert::assertNotNull, (data, exception) -&gt; {
                    fail(exception.getMessage());
                    <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">null</span>;
                }).get().execute();

        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;MyRecord&gt; records = components.getCollectedData(MyRecord.class); <i class="conum" data-value="3"></i><b>(3)</b>
        doAssertRecords(records); <span style="color:#777">// depending your test</span>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the rule will create a component manager and provide two mock components: an emitter and a collector. Don&#8217;t forget to set the root package of your component to enable it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>you define any chain you want to test, it generally uses the mock as source or collector</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>you validate your component behavior, for a source you can assert the right records were emitted in the mock collect</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_mocking_the_output">2.1.1. Mocking the output</h4>
<div class="paragraph">
<p>Using the component "test"/"collector" as in previous sample stores all records emitted by the chain (typically your source)
in memory, you can then access them using <code>theSimpleComponentRule.getCollectoedRecord(type)</code>. Note that this method filters by type,
if you don&#8217;t care of the type just use <code>Object.class</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mocking_the_input">2.1.2. Mocking the input</h4>
<div class="paragraph">
<p>The input mocking is symmetric to the output but here you provide the data you want to inject:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyComponentTest</span> {

    <span style="color:#007">@Rule</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> SimpleComponentRule components = <span style="color:#080;font-weight:bold">new</span> SimpleComponentRule(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.talend.sdk.component.mycomponent.</span><span style="color:#710">&quot;</span></span>);

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> produce() {
        components.setInputData(asList(createData(), createData(), createData())); <i class="conum" data-value="1"></i><b>(1)</b>

        ExecutionChainBuilder.start() <i class="conum" data-value="2"></i><b>(2)</b>
                .fromInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emitter</span><span style="color:#710">&quot;</span></span>, emptyMap())
                .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yourcomponentfamily</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myoutput</span><span style="color:#710">&quot;</span></span>, createComponentConfig())
                .create(components.asManager(), p -&gt; <span style="color:#069">null</span>, Assert::assertNotNull, (data, exception) -&gt; {
                    fail(exception.getMessage());
                    <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">null</span>;
                }).get().execute();

        assertMyOutputProcessedTheInputData();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>using <code>setInputData</code> you prepare the execution(s) to have a fake input when using "test"/"emitter" component.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_creating_runtime_configuration_from_component_configuration">2.1.3. Creating runtime configuration from component configuration</h4>
<div class="paragraph">
<p>The component configuration is a POJO (using <code>@Option</code> on fields) and the runtime configuration (<code>ExecutionChainBuilder</code>) uses
a <code>Map&lt;String, String&gt;</code>. To make the conversion easier, the JUnit integration provides a <code>SimpleFactory.configurationByExample</code> utility
to get this map instance from a configuration instance.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">final</span> MyComponentConfig componentConfig = <span style="color:#080;font-weight:bold">new</span> MyComponentConfig();
componentConfig.setUser(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">....</span><span style="color:#710">&quot;</span></span>);
<span style="color:#777">// .. other inits</span>

<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; configuration = configurationByExample(componentConfig);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_testing_a_mapper">2.1.4. Testing a Mapper</h4>
<div class="paragraph">
<p>The <code>SimpleComponentRule</code> also allows to test a mapper unitarly, you can get an instance from a configuration
and you can execute this instance to collect the output. Here is a snippet doing that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MapperTest</span> {

    <span style="color:#007">@ClassRule</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> SimpleComponentRule COMPONENT_FACTORY = <span style="color:#080;font-weight:bold">new</span> SimpleComponentRule(
            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.company.talend.component</span><span style="color:#710">&quot;</span></span>);

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> mapper() {
        <span style="color:#088;font-weight:bold">final</span> Mapper mapper = COMPONENT_FACTORY.createMapper(MyMapper.class, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Source</span>.Config() {{
            values = asList(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">b</span><span style="color:#710">&quot;</span></span>);
        }});
        assertEquals(asList(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">b</span><span style="color:#710">&quot;</span></span>), COMPONENT_FACTORY.collectAsList(<span style="color:#0a8;font-weight:bold">String</span>.class, mapper));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_testing_a_processor">2.1.5. Testing a Processor</h4>
<div class="paragraph">
<p>As for the mapper a processor is testable unitary. The case is a bit more complex since you can have multiple
inputs and outputs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ProcessorTest</span> {

    <span style="color:#007">@ClassRule</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> SimpleComponentRule COMPONENT_FACTORY = <span style="color:#080;font-weight:bold">new</span> SimpleComponentRule(
            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.company.talend.component</span><span style="color:#710">&quot;</span></span>);

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> processor() {
        <span style="color:#088;font-weight:bold">final</span> Processor processor = COMPONENT_FACTORY.createProcessor(Transform.class, <span style="color:#069">null</span>);
        <span style="color:#088;font-weight:bold">final</span> SimpleComponentRule.Outputs outputs = COMPONENT_FACTORY.collect(processor,
                        <span style="color:#080;font-weight:bold">new</span> JoinInputFactory().withInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">__default__</span><span style="color:#710">&quot;</span></span>, asList(<span style="color:#080;font-weight:bold">new</span> Transform.Record(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a</span><span style="color:#710">&quot;</span></span>), <span style="color:#080;font-weight:bold">new</span> Transform.Record(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bb</span><span style="color:#710">&quot;</span></span>)))
                                              .withInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">second</span><span style="color:#710">&quot;</span></span>, asList(<span style="color:#080;font-weight:bold">new</span> Transform.Record(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span>), <span style="color:#080;font-weight:bold">new</span> Transform.Record(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2</span><span style="color:#710">&quot;</span></span>)))
                );
        assertEquals(<span style="color:#00D">2</span>, outputs.size());
        assertEquals(asList(<span style="color:#00D">2</span>, <span style="color:#00D">3</span>), outputs.get(<span style="color:#0a8;font-weight:bold">Integer</span>.class, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">size</span><span style="color:#710">&quot;</span></span>));
        assertEquals(asList(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a1</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bb2</span><span style="color:#710">&quot;</span></span>), outputs.get(<span style="color:#0a8;font-weight:bold">String</span>.class, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value</span><span style="color:#710">&quot;</span></span>));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here again the rule allows you to instantiate a <code>Processor</code> from your code
and then to <code>collect</code> the output from the inputs you pass in. There are two convenient implementation
of the input factory:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>MainInputFactory</code> for processors using only the default input.</p>
</li>
<li>
<p><code>JoinInputfactory</code> for processors using multiple inputs have a method <code>withInput(branch, data)</code> The first arg is the branch name
and the second arg is the data used by the branch.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can also implement your own input representation if needed implementing <code>org.talend.sdk.component.junit.ControllableInputFactory</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_component_runtime_testing_spark">2.2. component-runtime-testing-spark</h3>
<div class="paragraph">
<p>The folowing artifact will allow you to test against a spark cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.talend.sdk.component<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>component-runtime-testing-spark<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${talend-component.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;scope&gt;</span>test<span style="color:#070;font-weight:bold">&lt;/scope&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage relies on a JUnit <code>TestRule</code>. It is recommanded to use it as a <code>@ClassRule</code> to ensure
a single instance of a spark cluster is built but you can also use it as a simple <code>@Rule</code> which means
it will be created per method instead of per test class.</p>
</div>
<div class="paragraph">
<p>It takes as parameter the spark and scala version to use. It will then fork a master and N slaves.
Finally it will give you <code>submit*</code> method allowing you to send jobs either from the test classpath
or from a shade if you run it as an integration test.</p>
</div>
<div class="paragraph">
<p>Here is a sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SparkClusterRuleTest</span> {

    <span style="color:#007">@ClassRule</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> SparkClusterRule SPARK = <span style="color:#080;font-weight:bold">new</span> SparkClusterRule(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2.10</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1.6.3</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>);

    <span style="color:#007">@Test</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> classpathSubmit() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
        SPARK.submitClasspath(SubmittableMain.class, getMainArgs());

        <span style="color:#777">// do wait the test passed</span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
this is working with <code>@Parameterized</code> so you can submit a bunch of jobs with different args and even combine it with beam <code>TestPipeline</code> if you make it <code>transient</code>!
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_how_to_know_the_job_is_done">2.2.1. How to know the job is done</h4>
<div class="paragraph">
<p>In current state, <code>SparkClusterRule</code> doesn&#8217;t allow to know a job execution is done - even if it exposes the webui url so
you can poll it to check. The best at the moment is to ensure the output of your job exists and contains the right value.</p>
</div>
<div class="paragraph">
<p><code>awaitability</code> or equivalent library can help you to write such logic.</p>
</div>
<div class="paragraph">
<p>Here are the coordinates of the artifact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.awaitility<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>awaitility<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;version&gt;</span>3.0.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;scope&gt;</span>test<span style="color:#070;font-weight:bold">&lt;/scope&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And here is how to wait a file exists and its content (for instance) is the expected one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">await()
    .atMost(<span style="color:#00D">5</span>, MINUTES)
    .until(
        () -&gt; out.exists() ? Files.readAllLines(out.toPath()).stream().collect(joining(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>)).trim() : <span style="color:#069">null</span>,
        equalTo(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">the expected content of the file</span><span style="color:#710">&quot;</span></span>));</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beam_testing">3. Beam testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to ensure your component works in Beam the minimum to do is to try with the direct runner (if you don&#8217;t want to use spark).</p>
</div>
<div class="paragraph">
<p>Check <a href="https://beam.apache.org/contribute/testing/" class="bare">beam.apache.org/contribute/testing/</a> out for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generating_data">4. Generating data?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Several data generator exists if you want to populate objects with a semantic a bit more evolved than a plain random string
like <code>commons-lang3</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/Codearte/jfairy" class="bare">github.com/Codearte/jfairy</a></p>
</li>
<li>
<p><a href="https://github.com/DiUS/java-faker" class="bare">github.com/DiUS/java-faker</a></p>
</li>
<li>
<p><a href="https://github.com/andygibson/datafactory" class="bare">github.com/andygibson/datafactory</a></p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A bit more advanced, these ones allow to bind directly generic data on a model - but data quality is not always there:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devopsfolks/podam" class="bare">github.com/devopsfolks/podam</a></p>
</li>
<li>
<p><a href="https://github.com/benas/random-beans" class="bare">github.com/benas/random-beans</a></p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note there are two main kind of implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the one using a <em>pattern</em> and random generated data</p>
</li>
<li>
<p>a set of precomputed data extrapolated to create new values</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Check against your use case to know which one is the best.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
an interesting alternative to data generation is to import <em>real</em> data and use Talend Studio to sanitize the data (remove sensitive information replacing them by generated data or anonymized data)
and just inject that file into the system.
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_talend_component_best_practices" class="sect0">Talend Component Best Practices</h1>
<div class="sect1">
<h2 id="_organize_your_code">1. Organize your code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Few recommandations apply to the way a component packages are organized:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ensure to create a <code>package-info.java</code> with the component family/categories at the root of your component package:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Components</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc</span><span style="color:#710">&quot;</span></span>, categories = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Database</span><span style="color:#710">&quot;</span></span>)
<span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.talend.sdk.component.jdbc</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.talend.sdk.component.api.component.Components</span>;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>create a package for the configuration</p>
</li>
<li>
<p>create a package for the actions</p>
</li>
<li>
<p>create a package for the component and one subpackage by type of component (input, output, processors, &#8230;&#8203;)</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modelize_your_configuration">2. Modelize your configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is recommanded to ensure your configuration is serializable since
it is likely you will pass it through your components which can be serialized.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_i_o_configuration">3. I/O configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first step to build a component is to identify the way it must be configured.</p>
</div>
<div class="paragraph">
<p>It is generally split into two main big concepts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the <em>DataStore</em> which is the way you can access the backend</p>
</li>
<li>
<p>the <em>DataSet</em> which is the way you interact with the backend</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here are some examples to let you get an idea of what you put in each categories:</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Example description</th>
<th class="tableblock halign-left valign-top">DataStore</th>
<th class="tableblock halign-left valign-top">DataSet</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accessing a relational database like MySQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the JDBC driver, url, username and password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the query to execute, row mapper, &#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access a file system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the file pattern (or directory + file extension/prefix/&#8230;&#8203;)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the file format, potentially the buffer size, &#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is common to make the dataset including the datastore since both are required to work. However it is recommanded to replace
this pattern by composing both in a higher level configuration model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@DataSet</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyDataSet</span> {
    <span style="color:#777">// ...</span>
}

<span style="color:#007">@DataStore</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyDataStore</span> {
    <span style="color:#777">// ...</span>
}


<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyComponentConfiguration</span> {
    <span style="color:#007">@Option</span>
    <span style="color:#088;font-weight:bold">private</span> MyDataSet dataset;

    <span style="color:#007">@Option</span>
    <span style="color:#088;font-weight:bold">private</span> MyDataStore datastore;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_processor_configuration">4. Processor configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Processor configuration is simpler than I/O configuration since it is specific each time. For instance a mapper
will take the mapping between the input and output model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MappingConfiguration</span> {
    <span style="color:#007">@Option</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; fieldsMapping;

    <span style="color:#007">@Option</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">boolean</span> ignoreCase;

    <span style="color:#777">//...</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_i_o_recommandations">5. I/O recommandations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I/O are particular because they can be linked to a set of actions. It is recommanded to wire all the ones you can apply
to ensure the consumers of your component can provide a rich experience to their users.</p>
</div>
<div class="paragraph">
<p>Here are the most common ones:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 12.5%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Configuration example</th>
<th class="tableblock halign-left valign-top">Action example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Discoverable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expose a way to get a schema representation of the dataset</p></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@DataSet</span>
<span style="color:#007">@Discoverable</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcDataSet</span>
  <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

   <span style="color:#007">@Option</span>
   <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> query;

   <span style="color:#007">@Option</span>
   <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> timeout;

   <span style="color:#777">// getters/setters</span>
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@DiscoverSchema</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Schema</span> findSchema(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataset</span><span style="color:#710">&quot;</span></span>) JdbcDataSet dataSet) {
    <span style="color:#080;font-weight:bold">return</span> extractSchemaFrom(dataSet);
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Checkable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expose a way to ensure the datastore/connection works</p></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@DataStore</span>
<span style="color:#007">@Checkable</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcDataStore</span>
  <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

  <span style="color:#007">@Option</span>
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> driver;

  <span style="color:#007">@Option</span>
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> url;

  <span style="color:#007">@Option</span>
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> username;

  <span style="color:#007">@Option</span>
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> password;
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@HealthCheck</span>
<span style="color:#088;font-weight:bold">public</span> HealthCheckStatus healthCheck(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">datastore</span><span style="color:#710">&quot;</span></span>) JdbcDataStore datastore) {
    <span style="color:#080;font-weight:bold">if</span> (!doTest(dataStore)) {
        <span style="color:#777">// often add an exception message mapping or equivalent</span>
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> HealthCheckStatus(Status.KO, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Test failed</span><span style="color:#710">&quot;</span></span>);
    }
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> HealthCheckStatus(Status.KO, e.getMessage());
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_i_o_limitations">6. I/O limitations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Until the studio integration is complete, it is recommanded to limit processors to 1 input.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handle_ui_interactions">7. Handle UI interactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is also recommanded to provide as much information as possible to let the UI work with the data during its edition.</p>
</div>
<div class="sect2">
<h3 id="_validations">7.1. Validations</h3>
<div class="sect3">
<h4 id="_light_validations">7.1.1. Light validations</h4>
<div class="paragraph">
<p>The light validations are all the validations you can execute on the client side. They are listed in the <a href="#documentation-ui-hints">UI hint</a> part.</p>
</div>
<div class="paragraph">
<p>This is the ones to use first before going with custom validations since they will be more efficient.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_validations">7.1.2. Custom validations</h4>
<div class="paragraph">
<p>These ones will enforce custom code to be executed, they are more heavy so try to avoid to use them for simple validations
you can do with the previous part.</p>
</div>
<div class="paragraph">
<p>Here you define an action taking some parameters needed for the validation and you link the option you want to validate to this action.
Here is an example to validate a dataset. For example for our JDBC driver we could have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// ...</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcDataStore</span>
  <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

  <span style="color:#007">@Option</span>
  <span style="color:#007">@Validable</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driver</span><span style="color:#710">&quot;</span></span>)
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> driver;

  <span style="color:#777">// ...</span>
}

<span style="color:#007">@AsyncValidation</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driver</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> ValidationResult validateDriver(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> driver) {
  <span style="color:#080;font-weight:bold">if</span> (findDriver(driver) != <span style="color:#069">null</span>) {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ValidationResult(Status.OK, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Driver found</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ValidationResult(Status.KO, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Driver not found</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you can also make a class validable and you can use it to validate a form if you put it on your whole configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// note: some part of the API were removed for brievity</span>

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConfiguration</span> {

  <span style="color:#777">// a lot of @Options</span>
}

<span style="color:#088;font-weight:bold">public</span> MyComponent {
    <span style="color:#088;font-weight:bold">public</span> MyComponent(<span style="color:#007">@Validable</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">configuration</span><span style="color:#710">&quot;</span></span>) MyConfiguration config) {
        <span style="color:#777">// ...</span>
    }

    <span style="color:#777">//...</span>
}

<span style="color:#007">@AsyncValidation</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">configuration</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> ValidationResult validateDriver(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value</span><span style="color:#710">&quot;</span></span>) MyConfiguration configuration) {
  <span style="color:#080;font-weight:bold">if</span> (isValid(configuration)) {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ValidationResult(Status.OK, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Configuration valid</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ValidationResult(Status.KO, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Driver not valid ${because ...}</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
the parameter binding of the validation method uses the same logic than the component configuration
injection. Therefore the <code>@Option</code> specifies the prefix to use to reference a parameter. It is recommanded to
use <code>@Option("value")</code> until you know exactly why you don&#8217;t use it. This way the consumer can match the configuration
model and just prefix it with <code>value.</code> to send the instance to validate.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_completion">7.2. Completion</h3>
<div class="paragraph">
<p>It can be neat and user friendly to provide completion on some fields. Here an example for the available drivers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// ...</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcDataStore</span>
  <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

  <span style="color:#007">@Option</span>
  <span style="color:#007">@Completable</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driver</span><span style="color:#710">&quot;</span></span>)
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> driver;

  <span style="color:#777">// ...</span>
}

<span style="color:#007">@Completion</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driver</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> CompletionList findDrivers() {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> CompletionList(findDriverList());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_don_t_forget_the_component_representation">7.3. Don&#8217;t forget the component representation</h3>
<div class="paragraph">
<p>Each component must have its own icon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Icon</span>(<span style="color:#0a8;font-weight:bold">Icon</span>.IconType.DB_INPUT)
<span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcPartitionMapper</span>
    <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can use <a href="http://talend.surge.sh/icons/" class="bare">talend.surge.sh/icons/</a> to identify the one you want to use.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version_and_component">8. Version and component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Not mandatory for the first version but recommanded: enforce the version of your component.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Version</span>(<span style="color:#00D">1</span>)
<span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcPartitionMapper</span>
    <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you break a configuration entry in a later version ensure to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>upgrade the version</p>
</li>
<li>
<p>support a migration of the configuration</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Version</span>(value = <span style="color:#00D">2</span>, migrationHandler = JdbcPartitionMapper.Migrations.class)
<span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JdbcPartitionMapper</span>
    <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Migrations</span> <span style="color:#088;font-weight:bold">implements</span> MigrationHandler {
        <span style="color:#777">// implement your migration</span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_don_t_forget_to_test">9. Don&#8217;t forget to test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing the components is crucial, you can use unit tests and simple standalone JUnit but it is highly recommanded
to have a few Beam tests to ensure your component works in Big Data world.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contribute_to_this_guide">10. Contribute to this guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Don&#8217;t hesitate to send your feedback on writing component and best practices you can encounter.</p>
</div>
</div>
</div>
<h1 id="_talend_component_rest_api_documentation" class="sect0">Talend Component REST API Documentation</h1>
<div class="sect1">
<h2 id="_rest_api">1. REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The REST API intends to expose over HTTP most of Talend Component features, it is a standalone Java HTTP server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
WebSocket protocol is activated for the endpoints as well, instead of <code>/api/v1</code> they uses the base <code>/websocket/v1</code>, see WebSocket part for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is the API:</p>
</div>
<div class="sect2">
<h3 id="_rest_resources_of_component_runtime_server">1.1. REST resources of Component Runtime :: Server</h3>
<div class="paragraph">
<p>1.0.0-SNAPSHOT</p>
</div>
<div class="sect3">
<h4 id="_code_post_api_v1_action_execute_code">1.1.1. <code>POST api/v1/action/execute</code></h4>
<div class="paragraph">
<p>This endpoint will execute any UI action and serialize the response as a JSON (pojo model). It takes as input the family, type and name of the related action to identify it and its configuration as a flat key value set using the same kind of mapping than for components (option path as key).</p>
</div>
<div class="sect4">
<h5 id="_request">Request</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code><br>
<strong>Request Body</strong>: (<code>java.util.Map&lt;java.lang.String, java.lang.String&gt;</code>)
<strong>Query Param</strong>: <code>action</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>family</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>type</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>java.lang.RuntimeException</code>)</p>
</div>
</div>
<div class="sect5">
<h6 id="_code_400_bad_request_code"><code>400 Bad Request</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.error.ErrorPayload</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>code</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ACTION_ERROR|ACTION_MISSING|BAD_FORMAT|COMPONENT_MISSING|DESIGN_MODEL_MISSING|ICON_MISSING|PLUGIN_MISSING|UNEXPECTED</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>description</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_code_404_not_found_code"><code>404 Not Found</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.error.ErrorPayload</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>code</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ACTION_ERROR|ACTION_MISSING|BAD_FORMAT|COMPONENT_MISSING|DESIGN_MODEL_MISSING|ICON_MISSING|PLUGIN_MISSING|UNEXPECTED</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>description</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_action_index_code">1.1.2. <code>GET api/v1/action/index</code></h4>
<div class="paragraph">
<p>This endpoint returns the list of available actions for a certain falimy and potentially filters the output limiting it to some falimies and types of actions.</p>
</div>
<div class="sect4">
<h5 id="_request_2">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Query Param</strong>: <code>family</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>language</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>type</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_2">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_2"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.ActionList</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>items</span><span style="color:#404">&quot;</span></span>: [
        {
            <span style="color:#606"><span style="color:#404">&quot;</span><span>component</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>properties</span><span style="color:#404">&quot;</span></span>: [
                {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>displayName</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>metadata</span><span style="color:#404">&quot;</span></span>: {
                    },
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>path</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>validation</span><span style="color:#404">&quot;</span></span>: {
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>enumValues</span><span style="color:#404">&quot;</span></span>: [
                            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                        ],
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>max</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>maxItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>maxLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>min</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>minItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>minLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>pattern</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>required</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>uniqueItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>
                    }
                }
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_component_details_code">1.1.3. <code>GET api/v1/component/details</code></h4>
<div class="paragraph">
<p>Returns the set of metadata about a few components identified by their 'id'.</p>
</div>
<div class="sect4">
<h5 id="_request_3">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Query Param</strong>: <code>identifiers</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>language</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_3">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_3"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.ComponentDetailList</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>details</span><span style="color:#404">&quot;</span></span>: [
        {
            <span style="color:#606"><span style="color:#404">&quot;</span><span>actions</span><span style="color:#404">&quot;</span></span>: [
                {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>family</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>properties</span><span style="color:#404">&quot;</span></span>: [
                        {
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>displayName</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>metadata</span><span style="color:#404">&quot;</span></span>: {
                            },
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>path</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                            <span style="color:#606"><span style="color:#404">&quot;</span><span>validation</span><span style="color:#404">&quot;</span></span>: {
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>enumValues</span><span style="color:#404">&quot;</span></span>: [
                                    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                                ],
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>max</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>maxItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>maxLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>min</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>minItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>minLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>pattern</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>required</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>,
                                <span style="color:#606"><span style="color:#404">&quot;</span><span>uniqueItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>
                            }
                        }
                    ],
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                }
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>displayName</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>icon</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>id</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>family</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>id</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>plugin</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>inputFlows</span><span style="color:#404">&quot;</span></span>: [
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>links</span><span style="color:#404">&quot;</span></span>: [
                {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>contentType</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>path</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                }
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>outputFlows</span><span style="color:#404">&quot;</span></span>: [
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>properties</span><span style="color:#404">&quot;</span></span>: [
                {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>displayName</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>metadata</span><span style="color:#404">&quot;</span></span>: {
                    },
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>path</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>validation</span><span style="color:#404">&quot;</span></span>: {
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>enumValues</span><span style="color:#404">&quot;</span></span>: [
                            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                        ],
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>max</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>maxItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>maxLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>min</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>minItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>minLength</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>pattern</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>required</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>,
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>uniqueItems</span><span style="color:#404">&quot;</span></span>: <span style="color:#069">false</span>
                    }
                }
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>type</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>version</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>
        }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_code_400_bad_request_code_2"><code>400 Bad Request</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>java.util.Map&lt;java.lang.String, org.talend.sdk.component.server.front.model.error.ErrorPayload&gt;</code>)</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_component_icon_family_id_code">1.1.4. <code>GET api/v1/component/icon/family/{id}</code></h4>
<div class="paragraph">
<p>Returns a particular family icon in raw bytes.</p>
</div>
<div class="sect4">
<h5 id="_request_4">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Path Param</strong>: <code>id</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_4">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_4"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>byte[]</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_code_404_not_found_code_2"><code>404 Not Found</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.error.ErrorPayload</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>code</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ACTION_ERROR|ACTION_MISSING|BAD_FORMAT|COMPONENT_MISSING|DESIGN_MODEL_MISSING|ICON_MISSING|PLUGIN_MISSING|UNEXPECTED</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>description</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_component_icon_id_code">1.1.5. <code>GET api/v1/component/icon/{id}</code></h4>
<div class="paragraph">
<p>Returns a particular component icon in raw bytes.</p>
</div>
<div class="sect4">
<h5 id="_request_5">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Path Param</strong>: <code>id</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_5">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_5"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>byte[]</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_code_404_not_found_code_3"><code>404 Not Found</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.error.ErrorPayload</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>code</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ACTION_ERROR|ACTION_MISSING|BAD_FORMAT|COMPONENT_MISSING|DESIGN_MODEL_MISSING|ICON_MISSING|PLUGIN_MISSING|UNEXPECTED</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>description</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_component_index_code">1.1.6. <code>GET api/v1/component/index</code></h4>
<div class="paragraph">
<p>Returns the list of available components.</p>
</div>
<div class="sect4">
<h5 id="_request_6">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Query Param</strong>: <code>language</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_6">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_6"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.ComponentIndices</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>components</span><span style="color:#404">&quot;</span></span>: [
        {
            <span style="color:#606"><span style="color:#404">&quot;</span><span>categories</span><span style="color:#404">&quot;</span></span>: [
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>displayName</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>icon</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>customIcon</span><span style="color:#404">&quot;</span></span>: {
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>customIconType</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>icon</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>iconFamily</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>customIcon</span><span style="color:#404">&quot;</span></span>: {
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>customIconType</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>icon</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>id</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>family</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>id</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>plugin</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>links</span><span style="color:#404">&quot;</span></span>: [
                {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>contentType</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>path</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">string</span><span style="color:#710">&quot;</span></span>
                }
            ],
            <span style="color:#606"><span style="color:#404">&quot;</span><span>version</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_post_api_v1_component_migrate_id_configurationversion_code">1.1.7. <code>POST api/v1/component/migrate/{id}/{configurationVersion}</code></h4>
<div class="paragraph">
<p>Allows to migrate a component configuration without calling any component execution.</p>
</div>
<div class="sect4">
<h5 id="_request_7">Request</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code><br>
<strong>Request Body</strong>: (<code>java.util.Map&lt;java.lang.String, java.lang.String&gt;</code>)
<strong>Path Param</strong>: <code>configurationVersion</code>, <code>int</code><br>
<strong>Path Param</strong>: <code>id</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_7">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_7"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>java.util.Map&lt;java.lang.String, java.lang.String&gt;</code>)</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_get_api_v1_configurationtype_index_code">1.1.8. <code>GET api/v1/configurationtype/index</code></h4>
<div class="paragraph">
<p>Returns all available configuration type - storable models.</p>
</div>
<div class="sect4">
<h5 id="_request_8">Request</h5>
<div class="paragraph">
<p><em>No body</em><br>
<strong>Query Param</strong>: <code>language</code>, <code>java.lang.String</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_8">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_200_ok_code_8"><code>200 OK</code></h6>
<div class="paragraph">
<p><strong>Response Body</strong>: (<code>org.talend.sdk.component.server.front.model.ConfigTypeNodes</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>nodes</span><span style="color:#404">&quot;</span></span>: {
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_post_api_v1_execution_read_family_component_code">1.1.9. <code>POST api/v1/execution/read/{family}/{component}</code></h4>
<div class="paragraph">
<p>Read inputs from an instance of mapper. The number of returned records if enforced to be limited to 1000. The format is a JSON based format where each like is a json record.</p>
</div>
<div class="sect4">
<h5 id="_request_9">Request</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code><br>
<strong>Request Body</strong>: (<code>java.util.Map&lt;java.lang.String, java.lang.String&gt;</code>)
<strong>Path Param</strong>: <code>component</code>, <code>java.lang.String</code><br>
<strong>Path Param</strong>: <code>family</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>size</code>, <code>long</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_9">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>talend/stream</code></p>
</div>
<div class="sect5">
<h6 id="_code_204_no_content_code"><code>204 No Content</code></h6>

</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_post_api_v1_execution_write_family_component_code">1.1.10. <code>POST api/v1/execution/write/{family}/{component}</code></h4>
<div class="paragraph">
<p>Sends records using a processor instance. Note that the processor should have only an input. Behavior for other processors is undefined. The input format is a JSON based format where each like is a json record - same as for the symmetric endpoint.</p>
</div>
<div class="sect4">
<h5 id="_request_10">Request</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>talend/stream</code><br>
<strong>Request Body</strong>: (<code>java.io.InputStream</code>)
<strong>Path Param</strong>: <code>component</code>, <code>java.lang.String</code><br>
<strong>Path Param</strong>: <code>family</code>, <code>java.lang.String</code><br>
<strong>Query Param</strong>: <code>group-size</code>, <code>long</code><br></p>
</div>
</div>
<div class="sect4">
<h5 id="_response_10">Response</h5>
<div class="paragraph">
<p><strong>Content-Type</strong>: <code>application/json</code></p>
</div>
<div class="sect5">
<h6 id="_code_204_no_content_code_2"><code>204 No Content</code></h6>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
to ensure the migration can be activated you need to set in the execution configuration you send to the server
the version it was created with (component version, it is in component detail endpoint) with the key <code>tcomp::component::version</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_websocket_transport">1.2. WebSocket transport</h3>
<div class="paragraph">
<p>You can connect on any endpoint replacing <code>/api</code> by <code>/websocket</code> and appending <code>/&lt;http method&gt;</code> for the URL and formatting the request as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>SEND
destination: &lt;endpoint after v1&gt;
&lt;headers&gt;

&lt;payload&gt;^@</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>SEND
destination: /component/index
Accept: application/json

^@</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response is formatted as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>MESSAGE
status: &lt;http status code&gt;
&lt;headers&gt;

&lt;payload&gt;^@</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
if you have a doubt about the endpoint, they are all logged during startup and you can find them in the logs.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_forms_and_rest_api">2. Web forms and REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>component-form</code> library provides a way to build a component REST API facade compatible with react form library.</p>
</div>
<div class="paragraph">
<p>A trivial facade can be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Path</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">tcomp-facade</span><span style="color:#710">&quot;</span></span>)
<span style="color:#007">@ApplicationScoped</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ComponentFacade</span> {

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">private</span> Client client;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">private</span> UiSpecService uiSpecService;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">private</span> ActionService actionService;

    <span style="color:#007">@POST</span>
    <span style="color:#007">@Path</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">action</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> UiActionResult action(<span style="color:#007">@QueryParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">family</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> family, <span style="color:#007">@QueryParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">type</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> type,
            <span style="color:#007">@QueryParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">action</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> action, <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; params) {
        <span style="color:#080;font-weight:bold">try</span> {
            <span style="color:#080;font-weight:bold">return</span> actionService.map(type, client.action(family, type, action, params));
        } <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#088;font-weight:bold">final</span> WebException exception) {
            <span style="color:#088;font-weight:bold">final</span> UiActionResult payload = actionService.map(exception);
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> WebApplicationException(Response.status(exception.getStatus()).entity(payload).build());
        }
    }

    <span style="color:#007">@GET</span>
    <span style="color:#007">@Path</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">index</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> ComponentIndices getIndex(<span style="color:#007">@QueryParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">language</span><span style="color:#710">&quot;</span></span>) <span style="color:#007">@DefaultValue</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">en</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> language) {
        <span style="color:#088;font-weight:bold">final</span> ComponentIndices index = client.index(language);
        <span style="color:#777">// our mapping is a bit different so rewrite links</span>
        index.getComponents().stream().flatMap(c -&gt; c.getLinks().stream()).forEach(link -&gt; link.setPath(
                link.getPath().replaceFirst(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\\</span><span style="color:#D20">/component</span><span style="color:#b0b">\\</span><span style="color:#D20">/</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\\</span><span style="color:#D20">/tcomp-facade</span><span style="color:#b0b">\\</span><span style="color:#D20">/</span><span style="color:#710">&quot;</span></span>).replace(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/details?identifiers=</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/detail/</span><span style="color:#710">&quot;</span></span>)));
        <span style="color:#080;font-weight:bold">return</span> index;
    }

    <span style="color:#007">@GET</span>
    <span style="color:#007">@Path</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">detail/{id}</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> UiSpecPayload getDetail(<span style="color:#007">@QueryParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">language</span><span style="color:#710">&quot;</span></span>) <span style="color:#007">@DefaultValue</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">en</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> language,
            <span style="color:#007">@PathParam</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">id</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> id) {
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;ComponentDetail&gt; details = client.details(language, id, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">String</span>[<span style="color:#00D">0</span>]).getDetails();
        <span style="color:#080;font-weight:bold">if</span> (details.isEmpty()) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> WebApplicationException(Response.Status.BAD_REQUEST);
        }
        <span style="color:#080;font-weight:bold">return</span> uiSpecService.convert(details.iterator().next());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the <code>Client</code> can be created using <code>ClientFactory.createDefault(System.getProperty("app.components.base", "http://localhost:8080/api/v1"))</code>
and the service can be a simple <code>new UiSpecService()</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the conversion between component model (REST API) and uiSpec model is done through the <code>UiSpecService</code>. It is based on the object model
which will be mapped to a ui model. The advantage to have a flat model in the component REST API is to make these layers easy to customize.</p>
</div>
<div class="paragraph">
<p>You can completely control the available components, tune the rendering switching the <code>uiSchema</code> if desired or add/remove part of the form.
You can also add custom actions/buttons for specific needs of the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the <code>/migrate</code> endpoint has nothing special so was not shown in previous snippet but if you need it you must add it as well.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging">3. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The logging uses Log4j2, you can specify a custom configuration using the system property <code>-Dlog4j.configurationFile</code>
or adding a <code>log4j2.xml</code> file into the classpath.</p>
</div>
<div class="paragraph">
<p>Here are some common configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Console logging:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;Configuration</span> <span style="color:#b48">status</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFO</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;Appenders&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Console</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Console</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">target</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SYSTEM_OUT</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;PatternLayout</span> <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">[%d{HH:mm:ss.SSS}][%highlight{%-5level}][%15.15t][%30.30logger] %msg%n</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Console&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/Appenders&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;Loggers&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Root</span> <span style="color:#b48">level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFO</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;AppenderRef</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Console</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Root&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/Loggers&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/Configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This outputs messages looking like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[16:59:58.198][INFO ][           main][oyote.http11.Http11NioProtocol] Initializing ProtocolHandler ["http-nio-34763"]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>JSON logging:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;Configuration</span> <span style="color:#b48">status</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFO</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;Properties&gt;</span>
    <span style="color:#777">&lt;!-- DO NOT PUT logSource there, it is useless and slow --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jsonLayout</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>{&quot;severity&quot;:&quot;%level&quot;,&quot;logMessage&quot;:&quot;%encode{%message}{JSON}&quot;,&quot;logTimestamp&quot;:&quot;%d{ISO8601}{UTC}&quot;,&quot;eventUUID&quot;:&quot;%uuid{RANDOM}&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;logger.name&quot;:&quot;%encode{%logger}{JSON}&quot;,&quot;host.name&quot;:&quot;${hostName}&quot;,&quot;threadName&quot;:&quot;%encode{%thread}{JSON}&quot;,&quot;stackTrace&quot;:&quot;%encode{%xThrowable{full}}{JSON}&quot;}%n<span style="color:#070;font-weight:bold">&lt;/Property&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/Properties&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;Appenders&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Console</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Console</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">target</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SYSTEM_OUT</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;PatternLayout</span> <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jsonLayout}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Console&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/Appenders&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;Loggers&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Root</span> <span style="color:#b48">level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFO</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;AppenderRef</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Console</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Root&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/Loggers&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/Configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Output messages look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>{"severity":"INFO","logMessage":"Initializing ProtocolHandler [\"http-nio-46421\"]","logTimestamp":"2017-11-20T16:04:01,763","eventUUID":"8b998e17-7045-461c-8acb-c43f21d995ff","@version":"1","logger.name":"org.apache.coyote.http11.Http11NioProtocol","host.name":"TLND-RMANNIBUCAU","threadName":"main","stackTrace":""}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rolling file appender</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;?xml version="1.0"?&gt;
&lt;Configuration status="INFO"&gt;
  &lt;Appenders&gt;
    &lt;RollingRandomAccessFile name="File" fileName="${LOG_PATH}/application.log" filePattern="${LOG_PATH}/application-%d{yyyy-MM-dd}.log"&gt;
      &lt;PatternLayout pattern="[%d{HH:mm:ss.SSS}][%highlight{%-5level}][%15.15t][%30.30logger] %msg%n"/&gt;
      &lt;Policies&gt;
        &lt;SizeBasedTriggeringPolicy size="100 MB" /&gt;
        &lt;TimeBasedTriggeringPolicy interval="1" modulate="true"/&gt;
      &lt;/Policies&gt;
    &lt;/RollingRandomAccessFile&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Root level="INFO"&gt;
      &lt;AppenderRef ref="File"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details are available on <a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#RollingFileAppender">RollingFileAppender</a> documentation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
of course you can compose previous layout (message format) and appenders (where logs are written).
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_wrapping_a_beam_i_o" class="sect0">Wrapping a Beam I/O</h1>
<div class="sect1">
<h2 id="wrapping-a-beam-io__start">1. Limitations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This part is limited to particular kinds of <a href="https://beam.apache.org/">Beam</a> <code>PTransform</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>PTransform&lt;PBegin, PCollection&lt;?&gt;&gt;</code> for the inputs</p>
</li>
<li>
<p>the <code>PTransform&lt;PCollection&lt;?&gt;, PDone&gt;</code> for the outputs. The outputs also must use a single (composite or not) <code>DoFn</code> in their <code>apply</code> method.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wrap_an_input">2. Wrap an input</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Assume you want to wrap an input like this one (based on existing Beam ones):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@AutoValue</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> [<span style="color:#088;font-weight:bold">static</span>] <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Read</span> <span style="color:#088;font-weight:bold">extends</span> PTransform&lt;PBegin, PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;&gt; {

  <span style="color:#777">// config</span>

  <span style="color:#007">@Override</span>
  <span style="color:#088;font-weight:bold">public</span> PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; expand(<span style="color:#088;font-weight:bold">final</span> PBegin input) {
    <span style="color:#080;font-weight:bold">return</span> input.apply(
        org.apache.beam.sdk.io.Read.from(<span style="color:#080;font-weight:bold">new</span> BoundedElasticsearchSource(<span style="color:#950">this</span>, <span style="color:#069">null</span>)));
  }

  <span style="color:#777">// ... other transform methods</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To wrap the Read in a framework component you create a transform delegating to this one with a <code>@PartitionMapper</code> annotation
at least (you likely want to follow the best practices as well adding <code>@Icon</code> and <code>@Version</code>) and using <code>@Option</code> constructor injections
to configure the component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myfamily</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myname</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">WrapRead</span> <span style="color:#088;font-weight:bold">extends</span> PTransform&lt;PBegin, PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;&gt; {
  <span style="color:#088;font-weight:bold">private</span> PTransform&lt;PBegin, PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;&gt; delegate;

  <span style="color:#088;font-weight:bold">public</span> WrapRead(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataset</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> WrapReadDataSet dataset) {
    delegate = TheIO.read().withConfiguration(<span style="color:#950">this</span>.createConfigurationFrom(dataset));
  }

  <span style="color:#007">@Override</span>
  <span style="color:#088;font-weight:bold">public</span> PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; expand(<span style="color:#088;font-weight:bold">final</span> PBegin input) {
    <span style="color:#080;font-weight:bold">return</span> delegate.expand(input);
  }

  <span style="color:#777">// ... other methods like the mapping with the native configuration (createConfigurationFrom)</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wrap_an_output">3. Wrap an output</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Assume you want to wrap an output like this one (based on existing Beam ones):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@AutoValue</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> [<span style="color:#088;font-weight:bold">static</span>] <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Write</span> <span style="color:#088;font-weight:bold">extends</span> PTransform&lt;PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;, PDone&gt; {


    <span style="color:#777">// configuration withXXX(...)</span>

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> PDone expand(<span style="color:#088;font-weight:bold">final</span> PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; input) {
      input.apply(ParDo.of(<span style="color:#080;font-weight:bold">new</span> WriteFn(<span style="color:#950">this</span>)));
      <span style="color:#080;font-weight:bold">return</span> PDone.in(input.getPipeline());
    }

    <span style="color:#777">// other methods of the transform</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can wrap this output exactly the same way than for the inputs but using <code>@Processor</code> this time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@PartitionMapper</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myfamily</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myname</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">WrapRead</span> <span style="color:#088;font-weight:bold">extends</span> PTransform&lt;PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;, PDone&gt; {
  <span style="color:#088;font-weight:bold">private</span> PTransform&lt;PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;, PDone&gt; delegate;

  <span style="color:#088;font-weight:bold">public</span> WrapRead(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataset</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> WrapReadDataSet dataset) {
    delegate = TheIO.write().withConfiguration(<span style="color:#950">this</span>.createConfigurationFrom(dataset));
  }

  <span style="color:#007">@Override</span>
  <span style="color:#088;font-weight:bold">public</span> PDone expand(<span style="color:#088;font-weight:bold">final</span> PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; input) {
    <span style="color:#080;font-weight:bold">return</span> delegate.expand(input);
  }

  <span style="color:#777">// ... other methods like the mapping with the native configuration (createConfigurationFrom)</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tip">4. Tip</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Note that the class <code>org.talend.sdk.component.runtime.beam.transform.DelegatingTransform</code> fully delegates
to another transform the "expansion". Therefore you can extend it and just implement the configuration mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Processor</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beam</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BeamFileOutput</span> <span style="color:#088;font-weight:bold">extends</span> DelegatingTransform&lt;PCollection&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt;, PDone&gt; {

    <span style="color:#088;font-weight:bold">public</span> BeamFileOutput(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">output</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> output) {
        <span style="color:#950">super</span>(TextIO.write()
            .withSuffix(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>)
            .to(FileBasedSink.convertToFileResourceIfPossible(output)));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<h1 id="_talend_component_appendix" class="sect0">Talend Component Appendix</h1>
<div class="sect1">
<h2 id="_containermanager_or_the_classloader_manager">1. ContainerManager or the classloader manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The entry point of the API is the <code>ContainerManager</code>, it will enable
you to define what is the <code>Shared</code> classloader and to create children:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (<span style="color:#088;font-weight:bold">final</span> ContainerManager manager = <span style="color:#080;font-weight:bold">new</span> ContainerManager( <i class="conum" data-value="1"></i><b>(1)</b>
    ContainerManager.DependenciesResolutionConfiguration.builder() <i class="conum" data-value="2"></i><b>(2)</b>
        .resolver(<span style="color:#080;font-weight:bold">new</span> MvnDependencyListLocalRepositoryResolver(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">META-INF/talend/dependencies.list</span><span style="color:#710">&quot;</span></span>))
        .rootRepositoryLocation(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="color:#0a8;font-weight:bold">System</span>.getProperty(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">user.home</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">.m2/repository</span><span style="color:#710">&quot;</span></span>))
        .create(),
    ContainerManager.ClassLoaderConfiguration.builder() <i class="conum" data-value="3"></i><b>(3)</b>
        .parent(getClass().getClassLoader())
        .classesFilter(name -&gt; <span style="color:#069">true</span>)
        .parentClassesFilter(name -&gt; <span style="color:#069">true</span>)
        .create())) {

    <span style="color:#777">// create plugins</span>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the <code>ContainerManager</code> is an <code>AutoCloseable</code> so you can use it in a try/finally block if desired.
NOTE: it is recommanded to keep it running if you can reuse plugins to avoid to recreate classloaders and to
mutualize them. This manager has two main configuration entries: how to resolve dependencies for plugins from the plugin
file/location and how to configure the classloaders (what is the parent classloader, how to handle the parent first/last
delegation etc&#8230;&#8203;).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the <code>DependenciesResolutionConfiguration</code> enables to pass a custom <code>Resolver</code> which will be used to build the plugin classloaders.
For now the library only provides <code>MvnDependencyListLocalRepositoryResolver</code> which will read the output of <code>mvn dependencies:list</code>
put in the plugin jar and will resolve from a <strong>local</strong> maven repository the dependencies. Note that <code>SNAPSHOT</code> are only resolved based on their name
and not from metadata (only useful in development). To continue the comparison to a Servlet server, you can easily implement an unpacked war resolver if you want.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the <code>ClassLoaderConfiguration</code> is configuring how the whole container/plugin pair will behave: what is the shared classloader?, which classes
are loaded from the shared loader first (intended to be used for API which shouldn&#8217;t be loaded from the plugin loader), which classes are loaded from
the parent classloader (useful to exclude to load a "common" library from the parent classloader for instance, can be neat for guava, commons-lang3 etc&#8230;&#8203;).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you have a manager you can create plugins:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Container</span> plugin1 = manager.create( <i class="conum" data-value="1"></i><b>(1)</b>
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">plugin-id</span><span style="color:#710">&quot;</span></span>, <i class="conum" data-value="2"></i><b>(2)</b>
    <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/plugin/myplugin1.jar</span><span style="color:#710">&quot;</span></span>)); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>to create a plugin <code>Container</code> just use the <code>create</code> method of the manager</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>you can give an explicit id to the plugin (or if you bypass it, the manager will use the jar name)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>you specify the plugin root jar</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To create the plugin container, the <code>Resolver</code> will resolve the dependencies needed for the plugin, then the manager will
create the plugin classloader and register the plugin <code>Container</code>.</p>
</div>
<div class="sect2">
<h3 id="_listener_for_plugin_registration">1.1. Listener for plugin registration</h3>
<div class="paragraph">
<p>It is common to need to do some actions when a plugin is registered/unregistered. For that purpose <code>ContainerListener</code> can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyListener</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">ContainerListener</span> {
    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onCreate(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Container</span> container) {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Container #</span><span style="color:#710">&quot;</span></span> + container.getId() + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20"> started.</span><span style="color:#710">&quot;</span></span>);
    }

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onClose(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Container</span> container) {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Container #</span><span style="color:#710">&quot;</span></span> + container.getId() + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20"> stopped.</span><span style="color:#710">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>They are registered on the manager directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">final</span> ContainerManager manager = getContainerManager();
<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">ContainerListener</span> myListener = <span style="color:#080;font-weight:bold">new</span> MyListener();

manager.registerListener(myListener); <i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#777">// do something</span>
manager.unregisterListener(myListener); <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>registerListener</code> is used to add the listener from now on, it will not get any event for already created containers.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>you can remove a listener with <code>unregisterListener</code> at any time.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_presentations">2. Presentations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can find some <em>high level</em> presentations of Talend Component framework at:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="presentations/overview/index.html">Overview</a></p>
</li>
<li>
<p><a href="presentations/programming-model/index.html">Programming Model</a></p>
</li>
<li>
<p><a href="presentations/packaging/index.html">Packaging</a></p>
</li>
<li>
<p><a href="presentations/testing/index.html">Testing</a></p>
</li>
</ul>
</div>
</div>
</div>
            </div>
            
        </div>
    </div>


    <footer>
        <div class="row">
          <div class="col-lg-12">

            <ul class="list-unstyled">
              <li class="pull-right"><a href="#top">Back to top</a></li>
            </ul>
          </div>
        </div>
    </footer>
    </div>

    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap.js"></script>
  </body>
</html>

